-- MySQL dump 10.13  Distrib 8.0.43, for Win64 (x86_64)
--
-- Host: localhost    Database: colegiogestion
-- ------------------------------------------------------
-- Server version	9.4.0

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `alumnos`
--

DROP TABLE IF EXISTS `alumnos`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `alumnos` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombres` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `apellidos` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `correo` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `fecha_nacimiento` date DEFAULT NULL,
  `grado_id` int DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_grado` (`grado_id`),
  CONSTRAINT `fk_grado` FOREIGN KEY (`grado_id`) REFERENCES `grados` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=237 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `alumnos`
--

LOCK TABLES `alumnos` WRITE;
/*!40000 ALTER TABLE `alumnos` DISABLE KEYS */;
INSERT INTO `alumnos` VALUES (21,'Milagros','Candela','milagroscandela@gmail.com','2000-03-01',25),(22,'Luis','Torres','luistorres@gmail.com','2022-03-10',12),(23,'Ana','Rivas','anarivas@gmail.com','2022-08-22',12),(24,'Carlos','Vega','carlosvega@gmail.com','2022-01-15',12),(25,'Laura','Paredes','lauraparedes@gmail.com','2022-12-03',12),(26,'Diego','Herrera','diegoherrera@gmail.com','2022-04-07',12),(27,'Elena','Ruiz','elenaruiz@gmail.com','2022-06-18',12),(29,'Marco','Diaz','marcodiaz@gmail.com','2022-10-01',12),(30,'Lucia','Salas','luciasalas@gmail.com','2022-05-25',12),(31,'Pedro','Castillo','pedrocastillo@gmail.com','2022-02-28',12),(32,'Sofia','Ramos','sofiaramos@gmail.com','2022-09-12',12),(33,'Lucas','Perez','lucasperez@gmail.com','2021-04-10',13),(34,'Emma','Lopez','emmalopez@gmail.com','2021-07-22',13),(35,'Mateo','Garcia','mateogarcia@gmail.com','2021-03-15',13),(36,'Sofia','Torres','sofiatorres@gmail.com','2021-11-30',13),(37,'Diego','Martinez','diegomartinez@gmail.com','2021-05-05',13),(38,'Valeria','Diaz','valeriadiaz@gmail.com','2021-09-19',13),(39,'Santiago','Vargas','santiagovargas@gmail.com','2021-02-08',13),(40,'Camila','Ruiz','camilaruiz@gmail.com','2021-06-27',13),(41,'Benjamin','Ramos','benjaminramos@gmail.com','2021-10-03',13),(42,'Isabella','Santos','isabellasantos@gmail.com','2021-01-18',13),(43,'Dylan','Morales','dylanmorales@gmail.com','2021-08-09',13),(44,'Valentina','Flores','valentinaflores@gmail.com','2021-12-12',13),(45,'Thiago','Mendez','thiagomendez@gmail.com','2021-07-01',13),(46,'Lucia','Castro','luciacastro@gmail.com','2021-05-21',13),(47,'Gael','Campos','gaelcampos@gmail.com','2021-03-03',13),(48,'Aaron','Paredes','aaronparedes@gmail.com','2020-02-11',14),(49,'Daniela','Silva','danielasilva@gmail.com','2020-06-25',14),(50,'Ian','Cortez','iancortez@gmail.com','2020-10-03',14),(51,'Victoria','Reyes','victoriareyes@gmail.com','2020-04-15',14),(52,'Leonardo','Castillo','leonardocastillo@gmail.com','2020-01-29',14),(53,'Maria','Paz','mariapaz@gmail.com','2020-03-21',14),(54,'Bruno','Salazar','brunosalazar@gmail.com','2020-08-13',14),(55,'Renata','Herrera','renataherrera@gmail.com','2020-07-09',14),(56,'Samuel','Fuentes','samuelfuentes@gmail.com','2020-05-04',14),(57,'Alexa','Vega','alexavega@gmail.com','2020-11-20',14),(58,'Julian','Carrillo','juliancarrillo@gmail.com','2020-09-01',14),(59,'Zoe','Campos','zoecampos@gmail.com','2020-12-18',14),(60,'Andres','Luna','andresluna@gmail.com','2020-03-07',14),(61,'Martina','Gutierrez','martinagutierrez@gmail.com','2020-06-02',14),(62,'Cristian','Serrano','cristianserrano@gmail.com','2020-04-26',14),(63,'Lucas','Perez','lucasperez@gmail.com','2019-02-13',15),(64,'Emma','Lopez','emmalopez@gmail.com','2019-07-26',15),(65,'Mateo','Garcia','mateogarcia@gmail.com','2019-05-10',15),(66,'Sofia','Torres','sofiatorres@gmail.com','2019-03-18',15),(67,'Diego','Martinez','diegomartinez@gmail.com','2019-10-09',15),(68,'Valeria','Diaz','valeriadiaz@gmail.com','2019-08-05',15),(69,'Santiago','Vargas','santiagovargas@gmail.com','2019-01-22',15),(70,'Camila','Ruiz','camilaruiz@gmail.com','2019-06-14',15),(71,'Benjamin','Ramos','benjaminramos@gmail.com','2019-09-28',15),(72,'Isabella','Santos','isabellasantos@gmail.com','2019-04-04',15),(73,'Dylan','Morales','dylanmorales@gmail.com','2019-12-01',15),(74,'Valentina','Flores','valentinaflores@gmail.com','2019-11-11',15),(75,'Thiago','Mendez','thiagomendez@gmail.com','2019-03-02',15),(76,'Lucia','Castro','luciacastro@gmail.com','2019-06-07',15),(77,'Gael','Campos','gaelcampos@gmail.com','2019-08-21',15),(78,'Lucas','Diaz','lucasdiaz@gmail.com','2018-04-05',16),(79,'Emma','Garcia','emmagarcia@gmail.com','2018-09-12',16),(80,'Mateo','Ruiz','mateoruiz@gmail.com','2018-06-18',16),(81,'Sofia','Lopez','sofialopez@gmail.com','2018-01-23',16),(82,'Diego','Campos','diegocampos@gmail.com','2018-07-30',16),(83,'Valeria','Perez','valeriaperez@gmail.com','2018-02-14',16),(84,'Santiago','Ramos','santiagoramos@gmail.com','2018-10-09',16),(85,'Camila','Torres','camilatorres@gmail.com','2018-05-26',16),(86,'Benjamin','Santos','benjaminsantos@gmail.com','2018-03-03',16),(87,'Isabella','Flores','isabellaflores@gmail.com','2018-11-17',16),(88,'Dylan','Morales','dylanmorales@gmail.com','2018-08-01',16),(89,'Valentina','Martinez','valentinamartinez@gmail.com','2018-12-22',16),(90,'Thiago','Rosales','thiagorosales@gmail.com','2018-06-07',16),(91,'Lucia','Vargas','luciavargas@gmail.com','2018-03-29',16),(92,'Gael','Castro','gaelcastro@gmail.com','2018-09-05',16),(93,'Alex','Torres','alextorres@gmail.com','2017-03-05',17),(94,'Emma','Castro','emmacastro@gmail.com','2017-11-22',17),(95,'Thiago','Diaz','thiagodiaz@gmail.com','2017-05-12',17),(96,'Lucia','Morales','luciamorales@gmail.com','2017-02-19',17),(97,'Mateo','Chavez','mateochavez@gmail.com','2017-10-07',17),(98,'Camila','Paredes','camilaparedes@gmail.com','2017-08-16',17),(99,'Benjamin','Fuentes','benjaminfuentes@gmail.com','2017-06-30',17),(100,'Valentina','Garcia','valentinagarcia@gmail.com','2017-09-03',17),(101,'Santiago','Lopez','santiagolopez@gmail.com','2017-01-28',17),(102,'Isabella','Campos','isabellacampos@gmail.com','2017-07-11',17),(103,'Dylan','Vargas','dylanvargas@gmail.com','2017-12-02',17),(104,'Sofia','Rios','sofiarios@gmail.com','2017-04-24',17),(105,'Leonardo','Mendoza','leonardomendoza@gmail.com','2017-06-03',17),(106,'Zoe','Rosales','zoerosales@gmail.com','2017-10-19',17),(107,'Gabriel','Reyes','gabrielreyes@gmail.com','2017-02-10',17),(108,'Mateo','Diaz','mateodiaz@gmail.com','2016-01-22',18),(109,'Emma','Garcia','emmagarcia@gmail.com','2016-06-11',18),(110,'Thiago','Castro','thiagocastro@gmail.com','2016-03-18',18),(111,'Isabella','Lopez','isabellalopez@gmail.com','2016-08-27',18),(112,'Lucas','Ramos','lucasramos@gmail.com','2016-10-09',18),(113,'Sofia','Torres','sofiatorres@gmail.com','2016-02-14',18),(114,'Dylan','Martinez','dylanmartinez@gmail.com','2016-04-30',18),(115,'Camila','Paredes','camilaparedes@gmail.com','2016-07-01',18),(116,'Gabriel','Vargas','gabrielvargas@gmail.com','2016-12-15',18),(117,'Valeria','Morales','valeriamorales@gmail.com','2016-09-06',18),(118,'Leonardo','Rosales','leonardorosales@gmail.com','2016-05-21',18),(119,'Lucia','Reyes','luciareyes@gmail.com','2016-11-13',18),(120,'Diego','Santos','diegosantos@gmail.com','2016-03-03',18),(121,'Valentina','Campos','valentinacampos@gmail.com','2016-01-09',18),(122,'Alex','Navarro','alexnavarro@gmail.com','2016-06-28',18),(123,'Mateo','Garcia','mateogarcia@gmail.com','2015-04-12',19),(124,'Valeria','Lopez','valerialopez@gmail.com','2015-08-03',19),(125,'Thiago','Diaz','thiagodiaz@gmail.com','2015-01-28',19),(126,'Emma','Ruiz','emmaruiz@gmail.com','2015-06-17',19),(127,'Lucas','Torres','lucastorres@gmail.com','2015-10-09',19),(128,'Isabella','Vargas','isabellavargas@gmail.com','2015-03-23',19),(129,'Santiago','Perez','santiagoperez@gmail.com','2015-07-14',19),(130,'Camila','Campos','camilacampos@gmail.com','2015-09-27',19),(131,'Gabriel','Rosales','gabrielrosales@gmail.com','2015-05-08',19),(132,'Lucia','Ramos','luciaramos@gmail.com','2015-12-04',19),(133,'Dylan','Chavez','dylanchavez@gmail.com','2015-02-19',19),(134,'Valentina','Morales','valentinamorales@gmail.com','2015-11-11',19),(135,'Benjamin','Paredes','benjaminparedes@gmail.com','2015-03-01',19),(136,'Sofia','Santos','sofiasantos@gmail.com','2015-06-29',19),(137,'Gael','Martinez','gaelmartinez@gmail.com','2015-07-06',19),(138,'Lucas','Diaz','lucasdiaz@gmail.com','2014-01-19',20),(139,'Emma','Lopez','emmalopez@gmail.com','2014-07-25',20),(140,'Mateo','Ruiz','mateoruiz@gmail.com','2014-03-12',20),(141,'Valeria','Garcia','valeriagarcia@gmail.com','2014-06-30',20),(142,'Santiago','Torres','santiagotorres@gmail.com','2014-09-10',20),(143,'Camila','Castro','camilacastro@gmail.com','2014-05-04',20),(144,'Dylan','Perez','dylanperez@gmail.com','2014-12-11',20),(145,'Isabella','Campos','isabellacampos@gmail.com','2014-04-07',20),(146,'Gabriel','Vargas','gabrielvargas@gmail.com','2014-10-22',20),(147,'Lucia','Rosales','luciarosales@gmail.com','2014-02-27',20),(148,'Thiago','Chavez','thiagochavez@gmail.com','2014-08-16',20),(149,'Valentina','Ramos','valentinaramos@gmail.com','2014-06-01',20),(150,'Benjamin','Morales','benjaminmorales@gmail.com','2014-11-03',20),(151,'Sofia','Santos','sofiasantos@gmail.com','2014-09-08',20),(152,'Alex','Paredes','alexparedes@gmail.com','2014-03-21',20),(153,'Mateo','Garcia','mateogarcia@gmail.com','2013-01-15',21),(154,'Valeria','Lopez','valerialopez@gmail.com','2013-05-23',21),(155,'Thiago','Diaz','thiagodiaz@gmail.com','2013-07-08',21),(156,'Emma','Ruiz','emmaruiz@gmail.com','2013-11-27',21),(157,'Lucas','Torres','lucastorres@gmail.com','2013-03-03',21),(158,'Isabella','Vargas','isabellavargas@gmail.com','2013-06-14',21),(159,'Santiago','Perez','santiagoperez@gmail.com','2013-08-29',21),(160,'Camila','Campos','camilacampos@gmail.com','2013-04-10',21),(161,'Gabriel','Rosales','gabrielrosales@gmail.com','2013-09-06',21),(162,'Lucia','Ramos','luciaramos@gmail.com','2013-12-02',21),(163,'Dylan','Chavez','dylanchavez@gmail.com','2013-02-16',21),(164,'Valentina','Morales','valentinamorales@gmail.com','2013-06-26',21),(165,'Benjamin','Paredes','benjaminparedes@gmail.com','2013-10-01',21),(166,'Sofia','Santos','sofiasantos@gmail.com','2013-03-18',21),(167,'Alex','Castro','alexcastro@gmail.com','2013-05-12',21),(168,'Lucas','Morales','lucasmorales@gmail.com','2012-01-25',22),(169,'Emma','Garcia','emmagarcia@gmail.com','2012-07-18',22),(170,'Mateo','Torres','mateotorres@gmail.com','2012-03-09',22),(171,'Sofia','Lopez','sofialopez@gmail.com','2012-10-21',22),(172,'Diego','Perez','diegoperez@gmail.com','2012-05-04',22),(173,'Valeria','Diaz','valeriadiaz@gmail.com','2012-08-13',22),(174,'Santiago','Chavez','santiagochavez@gmail.com','2012-12-30',22),(175,'Camila','Ramos','camilaramos@gmail.com','2012-04-17',22),(176,'Benjamin','Vargas','benjaminvargas@gmail.com','2012-09-06',22),(177,'Isabella','Castro','isabellacastro@gmail.com','2012-06-26',22),(178,'Dylan','Rosales','dylanrosales@gmail.com','2012-11-02',22),(179,'Valentina','Rios','valentinarios@gmail.com','2012-02-10',22),(180,'Thiago','Mendoza','thiagomendoza@gmail.com','2012-03-29',22),(181,'Lucia','Campos','luciacampos@gmail.com','2012-07-31',22),(182,'Gael','Paredes','gaelparedes@gmail.com','2012-04-06',22),(183,'Mateo','Diaz','mateodiaz@gmail.com','2011-01-16',23),(184,'Valeria','Garcia','valeriagarcia@gmail.com','2011-07-28',23),(185,'Thiago','Torres','thiagotorres@gmail.com','2011-03-08',23),(186,'Emma','Lopez','emmalopez@gmail.com','2011-10-10',23),(187,'Lucas','Ruiz','lucasruiz@gmail.com','2011-05-13',23),(188,'Isabella','Vargas','isabellavargas@gmail.com','2011-08-25',23),(189,'Santiago','Perez','santiagoperez@gmail.com','2011-11-01',23),(190,'Camila','Castro','camilacastro@gmail.com','2011-04-03',25),(191,'Gabriel','Ramos','gabrielramos@gmail.com','2011-09-06',23),(192,'Lucia','Rosales','luciarosales@gmail.com','2011-06-22',23),(193,'Dylan','Martinez','dylanmartinez@gmail.com','2011-12-04',23),(194,'Valentina','Morales','valentinamorales@gmail.com','2011-02-19',23),(195,'Benjamin','Chavez','benjaminchavez@gmail.com','2011-03-27',23),(196,'Sofia','Santos','sofiasantos@gmail.com','2011-08-11',23),(197,'Alex','Paredes','alexparedes@gmail.com','2011-05-09',23),(198,'Lucas','Torres','lucastorres@gmail.com','2010-01-15',24),(199,'Emma','Garcia','emmagarcia@gmail.com','2010-06-22',24),(200,'Mateo','Lopez','mateolopez@gmail.com','2010-09-08',24),(201,'Sofia','Perez','sofiaperez@gmail.com','2010-03-30',24),(202,'Diego','Vargas','diegovargas@gmail.com','2010-12-05',24),(203,'Valeria','Ramos','valeriaramos@gmail.com','2010-07-12',24),(204,'Santiago','Castro','santiagocastro@gmail.com','2010-02-27',24),(205,'Camila','Chavez','camilachavez@gmail.com','2010-04-18',24),(206,'Benjamin','Ruiz','benjaminruiz@gmail.com','2010-08-06',24),(207,'Isabella','Rosales','isabellarosales@gmail.com','2010-05-11',24),(208,'Dylan','Diaz','dylandiaz@gmail.com','2010-10-28',24),(209,'Valentina','Morales','valentinamorales@gmail.com','2010-03-09',24),(210,'Thiago','Campos','thiagocampos@gmail.com','2010-11-16',24),(211,'Lucia','Paredes','luciaparedes@gmail.com','2010-01-24',24),(212,'Gabriel','Santos','gabrielsantos@gmail.com','2010-06-04',24),(213,'Mateo','Garcia','mateogarcia@gmail.com','2009-01-21',25),(214,'Valeria','Lopez','valerialopez@gmail.com','2009-06-15',25),(215,'Thiago','Torres','thiagotorres@gmail.com','2009-03-04',25),(216,'Emma','Perez','emmaperez@gmail.com','2009-10-29',25),(217,'Lucas','Diaz','lucasdiaz@gmail.com','2009-04-17',25),(218,'Isabella','Ramos','isabellaramos@gmail.com','2009-08-13',25),(219,'Santiago','Castro','santiagocastro@gmail.com','2009-02-02',25),(220,'Camila','Ruiz','camilaruiz@gmail.com','2009-07-28',25),(221,'Gabriel','Rosales','gabrielrosales@gmail.com','2009-05-03',25),(222,'Lucia','Vargas','luciavargas@gmail.com','2009-11-19',25),(223,'Dylan','Chavez','dylanchavez@gmail.com','2009-09-01',25),(224,'Valentina','Morales','valentinamorales@gmail.com','2009-03-25',25),(225,'Benjamin','Paredes','benjaminparedes@gmail.com','2009-06-07',25),(226,'Sofia','Santos','sofiasantos@gmail.com','2009-12-11',25),(227,'Alex','Campos','alexcampos@gmail.com','2009-04-08',25);
/*!40000 ALTER TABLE `alumnos` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `asistencias`
--

DROP TABLE IF EXISTS `asistencias`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `asistencias` (
  `id` int NOT NULL AUTO_INCREMENT,
  `alumno_id` int NOT NULL,
  `curso_id` int NOT NULL,
  `turno_id` int NOT NULL,
  `fecha` date NOT NULL,
  `hora_clase` time NOT NULL,
  `estado` enum('PRESENTE','TARDANZA','AUSENTE','JUSTIFICADO') COLLATE utf8mb4_unicode_ci NOT NULL,
  `observaciones` text COLLATE utf8mb4_unicode_ci,
  `registrado_por` int DEFAULT NULL COMMENT 'ID del profesor que registró la asistencia',
  `fecha_registro` datetime DEFAULT CURRENT_TIMESTAMP,
  `fecha_actualizacion` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `activo` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1=Registro activo, 0=Registro anulado',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_asistencia_diaria` (`alumno_id`,`curso_id`,`turno_id`,`fecha`,`hora_clase`),
  KEY `fk_asistencias_alumno` (`alumno_id`),
  KEY `fk_asistencias_curso` (`curso_id`),
  KEY `fk_asistencias_turno` (`turno_id`),
  KEY `idx_fecha` (`fecha`),
  KEY `idx_estado` (`estado`),
  KEY `idx_activo` (`activo`),
  KEY `idx_asistencias_fecha_curso_turno` (`fecha`,`curso_id`,`turno_id`),
  KEY `idx_asistencias_alumno_fecha_turno` (`alumno_id`,`fecha`,`turno_id`),
  CONSTRAINT `fk_asistencias_alumno` FOREIGN KEY (`alumno_id`) REFERENCES `alumnos` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_asistencias_curso` FOREIGN KEY (`curso_id`) REFERENCES `cursos` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_asistencias_turno` FOREIGN KEY (`turno_id`) REFERENCES `turnos` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=220 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `asistencias`
--

LOCK TABLES `asistencias` WRITE;
/*!40000 ALTER TABLE `asistencias` DISABLE KEYS */;
INSERT INTO `asistencias` VALUES (1,21,136,1,'2025-10-14','08:00:00','PRESENTE','Asistió puntual',8,'2025-10-16 18:21:41','2025-10-16 18:21:41',1),(2,21,136,1,'2025-10-12','08:00:00','TARDANZA','Llegó 10 minutos tarde',8,'2025-10-16 18:21:41','2025-10-16 18:21:41',1),(3,21,136,1,'2025-10-16','08:00:00','PRESENTE',NULL,8,'2025-10-16 18:21:41','2025-10-16 18:21:41',1),(4,21,140,1,'2025-10-13','10:00:00','PRESENTE',NULL,6,'2025-10-16 18:21:41','2025-10-16 18:21:41',1),(6,22,34,2,'2025-10-16','13:00:00','PRESENTE',NULL,8,'2025-10-16 18:21:41','2025-10-16 18:21:41',1),(7,23,34,2,'2025-10-16','13:00:00','TARDANZA','Llegó 15 minutos tarde',8,'2025-10-16 18:21:41','2025-10-16 18:21:41',1),(8,24,34,2,'2025-10-16','13:00:00','JUSTIFICADO',NULL,8,'2025-10-16 18:21:41','2025-10-18 02:38:04',1),(9,25,34,2,'2025-10-16','13:00:00','PRESENTE',NULL,8,'2025-10-16 18:21:41','2025-10-16 18:21:41',1),(13,227,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(15,219,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(16,223,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(17,217,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(18,213,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(19,214,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(20,224,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(21,225,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(22,216,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(23,218,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(24,221,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(25,220,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(26,226,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(27,215,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(28,222,140,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:29:54','2025-10-20 20:03:31',1),(29,31,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(30,29,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(31,26,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(32,25,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(33,32,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(34,23,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(35,27,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(36,30,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(37,22,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(38,24,22,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 00:31:09','2025-10-20 21:50:04',1),(39,181,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(40,177,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(41,174,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(42,173,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(43,169,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(44,171,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(45,180,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(46,168,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(47,182,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(48,172,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(49,175,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(50,179,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(51,178,104,1,'2025-10-20','08:00:00','JUSTIFICADO','',6,'2025-10-20 02:59:37','2025-10-20 21:54:31',1),(52,170,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(53,176,104,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 02:59:37','2025-10-20 20:06:30',1),(54,160,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(55,167,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(56,163,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(57,155,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(58,153,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(59,154,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(60,164,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(61,165,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(62,159,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(63,162,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(64,161,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(65,156,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(66,166,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(67,157,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(68,158,92,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:30:03','2025-10-20 20:02:15',1),(69,82,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(70,92,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(71,78,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(72,87,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(73,79,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(74,81,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(75,89,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(76,88,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(77,83,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(78,84,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(79,90,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(80,80,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(81,86,47,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(82,85,47,1,'2025-10-20','08:00:00','JUSTIFICADO','',6,'2025-10-20 15:31:34','2025-10-20 15:32:22',1),(83,91,47,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 15:31:34','2025-10-20 15:31:34',1),(84,190,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(85,195,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(86,183,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(87,184,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(88,186,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(89,193,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(90,194,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(91,197,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(92,189,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(93,191,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(94,192,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(95,187,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(96,196,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(97,185,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(98,188,116,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:30','2025-10-20 16:09:30',1),(99,121,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(100,110,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(101,108,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(102,109,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(103,111,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(104,114,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(105,117,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(106,122,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(107,115,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(108,112,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(109,119,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(110,118,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(111,120,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(112,113,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(113,116,65,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 16:09:52','2025-10-20 16:09:52',1),(114,210,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(115,204,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(116,205,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(117,208,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(118,199,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(119,200,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(120,209,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(121,211,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(122,201,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(123,203,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(124,207,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(125,206,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(126,212,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(127,198,128,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(128,202,128,1,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 19:16:10','2025-10-20 19:16:10',1),(129,102,56,1,'2025-10-20','08:00:00','JUSTIFICADO','',6,'2025-10-20 19:22:21','2025-10-20 19:25:11',1),(130,94,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(131,97,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(132,95,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(133,99,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(134,100,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(135,101,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(136,105,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(137,96,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(138,98,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(139,107,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(140,104,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(141,106,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(142,93,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(143,103,56,1,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 19:22:21','2025-10-20 19:22:21',1),(144,47,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(145,46,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(146,38,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(147,44,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(148,35,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(149,34,27,2,'2025-10-20','08:00:00','TARDANZA','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(150,37,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(151,45,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(152,43,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(153,33,27,2,'2025-10-20','08:00:00','AUSENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(154,41,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(155,40,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(156,42,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(157,36,27,2,'2025-10-20','08:00:00','PRESENTE','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(158,39,27,2,'2025-10-20','08:00:00','TARDANZA','',6,'2025-10-20 21:58:38','2025-10-20 21:58:38',1),(159,31,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(160,29,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(161,26,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(162,25,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(163,32,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(164,23,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(165,27,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(166,30,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(167,22,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(168,24,22,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:16:58','2025-10-26 21:16:58',1),(169,227,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(170,21,140,1,'2025-10-26','08:00:00','AUSENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(171,190,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(172,219,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(173,223,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(174,217,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(175,213,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(176,214,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(177,224,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(178,225,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(179,216,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(180,218,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(181,221,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(182,220,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(183,226,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(184,215,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(185,222,140,1,'2025-10-26','08:00:00','PRESENTE','',6,'2025-10-26 21:20:43','2025-10-26 21:20:43',1),(186,227,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(187,21,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(188,190,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(189,219,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(190,223,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(191,217,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(192,213,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(193,214,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(194,224,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(195,225,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(196,216,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(197,218,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(198,221,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(199,220,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(200,226,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(201,215,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(202,222,140,1,'2025-11-25','08:00:00','PRESENTE','',6,'2025-11-25 11:57:28','2025-11-25 11:57:28',1),(203,227,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(204,21,140,1,'2025-11-29','08:00:00','JUSTIFICADO','',6,'2025-11-29 23:41:35','2025-11-29 23:42:42',1),(205,190,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(206,219,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(207,223,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(208,217,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(209,213,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(210,214,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(211,224,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(212,225,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(213,216,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(214,218,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(215,221,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(216,220,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(217,226,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(218,215,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1),(219,222,140,1,'2025-11-29','08:00:00','PRESENTE','',6,'2025-11-29 23:41:35','2025-11-29 23:41:35',1);
/*!40000 ALTER TABLE `asistencias` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `aulas`
--

DROP TABLE IF EXISTS `aulas`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `aulas` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `capacidad` int DEFAULT NULL,
  `sede_id` int NOT NULL,
  `activo` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1=Activo, 0=Inactivo',
  PRIMARY KEY (`id`),
  KEY `fk_aulas_sede` (`sede_id`),
  KEY `idx_aulas_sede_activo` (`sede_id`,`activo`),
  CONSTRAINT `fk_aulas_sede` FOREIGN KEY (`sede_id`) REFERENCES `sedes` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `aulas`
--

LOCK TABLES `aulas` WRITE;
/*!40000 ALTER TABLE `aulas` DISABLE KEYS */;
INSERT INTO `aulas` VALUES (1,'A-101',30,1,1),(2,'A-102',30,1,1),(3,'A-201',30,1,1),(4,'A-202',30,1,1),(5,'B-101',25,1,1),(6,'B-102',25,1,1),(7,'Laboratorio Cómputo',20,1,1),(8,'N-101',30,2,1),(9,'N-102',30,2,1),(10,'N-201',30,2,1),(11,'S-101',30,3,1),(12,'S-102',30,3,1),(13,'S-103',30,3,1);
/*!40000 ALTER TABLE `aulas` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `cursos`
--

DROP TABLE IF EXISTS `cursos`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `cursos` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `grado_id` int DEFAULT NULL,
  `profesor_id` int DEFAULT NULL,
  `creditos` int DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_cursos_grados` (`grado_id`),
  KEY `fk_cursos_profesores` (`profesor_id`),
  CONSTRAINT `fk_cursos_grados` FOREIGN KEY (`grado_id`) REFERENCES `grados` (`id`),
  CONSTRAINT `fk_cursos_profesores` FOREIGN KEY (`profesor_id`) REFERENCES `profesores` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=148 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `cursos`
--

LOCK TABLES `cursos` WRITE;
/*!40000 ALTER TABLE `cursos` DISABLE KEYS */;
INSERT INTO `cursos` VALUES (14,'Historia',19,5,1),(17,'Religion',22,5,1),(19,'Psicomotricidad',12,12,1),(20,'Lenguaje Oral',12,9,1),(21,'Numeros Basicos',12,7,1),(22,'Cuentos y Relatos',12,6,1),(23,'Expresion Artistica',12,13,1),(24,'Motricidad Fina y Gruesa',13,12,1),(25,'Iniciacion al Lenguaje',13,9,1),(26,'Matematica Divertida',13,8,1),(27,'Historias para Imaginar',13,6,1),(28,'Dibujo y Pintura',13,13,1),(29,'Precalculo y Numeracion',14,14,1),(30,'Lectura de Imagenes',14,9,1),(31,'Descubriendo la Naturaleza',14,5,1),(32,'Mi Cuerpo en Movimiento',14,12,1),(33,'Arte y Creatividad',14,13,1),(34,'Aritmetica',15,8,1),(35,'Geometria Basica',15,7,1),(36,'Gramatica',15,9,1),(37,'Comprension Lectora',15,9,1),(38,'Personal Social',15,6,1),(39,'Ciencia y Ambiente',15,5,1),(40,'Educacion Fisica',15,12,1),(41,'Arte y Cultura',15,13,1),(42,'Computacion',15,17,1),(43,'Aritmetica',16,8,1),(44,'Geometria Basica',16,7,1),(45,'Gramatica',16,9,1),(46,'Comprension Lectora',16,9,1),(47,'Personal Social',16,6,1),(48,'Ciencia y Ambiente',16,5,1),(49,'Educacion Fisica',16,12,1),(50,'Arte y Cultura',16,13,1),(51,'Computacion',16,17,1),(52,'Aritmetica',17,8,1),(53,'Geometria Basica',17,7,1),(54,'Redaccion',17,9,1),(55,'Comprension de Textos',17,9,1),(56,'Personal Social',17,6,1),(57,'Ciencia y Ambiente',17,5,1),(58,'Educacion Fisica',17,12,1),(59,'Arte y Cultura',17,13,1),(60,'Computacion',17,17,1),(61,'Aritmetica',18,8,1),(62,'Geometria',18,7,1),(63,'Redaccion y Ortografia',18,9,1),(64,'Lectura Comprensiva',18,9,1),(65,'Personal Social',18,6,1),(66,'Ciencia y Ambiente',18,5,1),(67,'Educacion Fisica',18,12,1),(68,'Arte y Cultura',18,13,1),(69,'Computacion',18,17,1),(70,'Aritmetica Avanzada',19,8,1),(71,'Geometria y Medicion',19,7,1),(72,'Produccion de Textos',19,9,1),(73,'Comprension Lectora Critica',19,9,1),(74,'Personal Social',19,6,1),(75,'Ciencia y Tecnologia',19,5,1),(76,'Educacion Fisica',19,12,1),(77,'Arte y Cultura',19,13,1),(78,'Computacion',19,17,1),(79,'Aritmetica',20,8,1),(80,'Geometria',20,7,1),(81,'Redaccion',20,9,1),(82,'Comprension Lectora',20,9,1),(83,'Personal Social',20,6,1),(84,'Ciencia y Tecnologia',20,5,1),(85,'Educacion Fisica',20,12,1),(86,'Arte y Cultura',20,13,1),(87,'Computacion',20,17,1),(88,'Algebra',21,8,1),(89,'Geometria',21,7,1),(90,'Comunicacion',21,9,1),(91,'Redaccion y Comprension',21,9,1),(92,'Historia del Peru',21,6,1),(93,'Geografia',21,10,1),(94,'Ciencia y Tecnologia',21,5,1),(95,'Fisica Basica',21,15,1),(96,'Educacion Fisica',21,12,1),(97,'Arte y Cultura',21,13,1),(98,'Computacion',21,17,1),(99,'Religion y Valores',21,16,1),(100,'Algebra',22,8,1),(101,'Geometria',22,7,1),(102,'Comunicacion',22,9,1),(103,'Lectura y Argumentacion',22,9,1),(104,'Historia Universal',22,6,1),(105,'Geografia del Peru',22,10,1),(106,'Ciencia y Tecnologia',22,5,1),(107,'Fisica y Quimica',22,15,1),(108,'Educacion Fisica',22,12,1),(109,'Arte y Cultura',22,13,1),(110,'Computacion',22,17,1),(111,'Formacion Religiosa',22,16,1),(112,'Algebra',23,8,1),(113,'Geometria y Trigonometria',23,7,1),(114,'Comunicacion',23,9,1),(115,'Analisis de Textos',23,9,1),(116,'Historia del Mundo',23,6,1),(117,'Geografia Politica',23,10,1),(118,'Ciencia y Tecnologia',23,5,1),(119,'Fisica y Quimica',23,15,1),(120,'Educacion Fisica',23,12,1),(121,'Arte y Cultura',23,13,1),(122,'Computacion',23,17,1),(123,'Formacion Ciudadana',23,16,1),(124,'Algebra',24,8,1),(125,'Geometria y Trigonometria',24,7,1),(126,'Comunicacion',24,9,1),(127,'Analisis de Textos',24,9,1),(128,'Historia del Peru',24,6,1),(129,'Geografia',24,10,1),(130,'Ciencia y Tecnologia',24,5,1),(131,'Fisica y Quimica',24,15,1),(132,'Educacion Fisica',24,12,1),(133,'Arte y Cultura',24,13,1),(134,'Computacion',24,17,1),(135,'Formacion Ciudadana',24,16,1),(136,'Algebra',25,8,1),(137,'Geometria y Trigonometria',25,7,1),(138,'Comunicacion',25,9,1),(139,'Analisis de Textos',25,9,1),(140,'Historia del Peru',25,6,1),(141,'Geografia',25,10,1),(142,'Ciencia y Tecnologia',25,5,1),(143,'Fisica y Quimica',25,15,1),(144,'Educacion Fisica',25,12,1),(145,'Arte y Cultura',25,13,1),(146,'Computacion',25,17,1),(147,'Formacion Ciudadana',25,16,1);
/*!40000 ALTER TABLE `cursos` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `grados`
--

DROP TABLE IF EXISTS `grados`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `grados` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `nivel` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=28 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `grados`
--

LOCK TABLES `grados` WRITE;
/*!40000 ALTER TABLE `grados` DISABLE KEYS */;
INSERT INTO `grados` VALUES (12,'3','Inicial'),(13,'4','Inicial'),(14,'5','Inicial'),(15,'1ero','Primaria'),(16,'2do','Primaria'),(17,'3ero','Primaria'),(18,'4to','Primaria'),(19,'5to','Primaria'),(20,'6to','Primaria'),(21,'1ero','Secundaria'),(22,'2do','Secundaria'),(23,'3ero','Secundaria'),(24,'4to','Secundaria'),(25,'5to','Secundaria');
/*!40000 ALTER TABLE `grados` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `horarios_clase`
--

DROP TABLE IF EXISTS `horarios_clase`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `horarios_clase` (
  `id` int NOT NULL AUTO_INCREMENT,
  `curso_id` int NOT NULL,
  `turno_id` int NOT NULL,
  `dia_semana` enum('LUNES','MARTES','MIERCOLES','JUEVES','VIERNES','SABADO') COLLATE utf8mb4_unicode_ci NOT NULL,
  `hora_inicio` time NOT NULL,
  `hora_fin` time NOT NULL,
  `aula_id` int NOT NULL,
  `activo` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1=Activo, 0=Inactivo',
  PRIMARY KEY (`id`),
  KEY `fk_horarios_curso` (`curso_id`),
  KEY `fk_horarios_turno` (`turno_id`),
  KEY `fk_horarios_aula` (`aula_id`),
  KEY `idx_horarios_dia_turno_activo` (`dia_semana`,`turno_id`,`activo`),
  CONSTRAINT `fk_horarios_aula` FOREIGN KEY (`aula_id`) REFERENCES `aulas` (`id`),
  CONSTRAINT `fk_horarios_curso` FOREIGN KEY (`curso_id`) REFERENCES `cursos` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_horarios_turno` FOREIGN KEY (`turno_id`) REFERENCES `turnos` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `horarios_clase`
--

LOCK TABLES `horarios_clase` WRITE;
/*!40000 ALTER TABLE `horarios_clase` DISABLE KEYS */;
INSERT INTO `horarios_clase` VALUES (1,136,1,'LUNES','08:00:00','09:30:00',1,1),(2,136,1,'MIERCOLES','08:00:00','09:30:00',1,1),(3,136,1,'VIERNES','08:00:00','09:30:00',1,1),(4,140,1,'LUNES','10:00:00','11:30:00',1,1),(5,140,1,'JUEVES','10:00:00','11:30:00',1,1),(6,34,2,'LUNES','13:00:00','14:00:00',5,1),(7,34,2,'MARTES','13:00:00','14:00:00',5,1),(8,34,2,'MIERCOLES','13:00:00','14:00:00',5,1),(9,34,2,'JUEVES','13:00:00','14:00:00',5,1),(10,34,2,'VIERNES','13:00:00','14:00:00',5,1),(11,19,1,'LUNES','08:00:00','09:00:00',6,1),(12,19,1,'MIERCOLES','08:00:00','09:00:00',6,1),(13,19,1,'VIERNES','08:00:00','09:00:00',6,1);
/*!40000 ALTER TABLE `horarios_clase` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `imagenes`
--

DROP TABLE IF EXISTS `imagenes`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `imagenes` (
  `id` int NOT NULL AUTO_INCREMENT,
  `alumno_id` int NOT NULL,
  `ruta` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `fecha_subida` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `alumno_id` (`alumno_id`),
  CONSTRAINT `imagenes_ibfk_1` FOREIGN KEY (`alumno_id`) REFERENCES `alumnos` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=27 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `imagenes`
--

LOCK TABLES `imagenes` WRITE;
/*!40000 ALTER TABLE `imagenes` DISABLE KEYS */;
INSERT INTO `imagenes` VALUES (17,31,'uploads/1752219686243_fotoeperfil.jpg','2025-07-11 02:41:26'),(24,21,'uploads/1752221160126_fotoeperfil.jpg','2025-07-11 03:06:00'),(25,21,'uploads/1758501078073_11569877522.png','2025-09-21 19:31:18'),(26,21,'uploads/1761517769984_15691221895.png','2025-10-26 17:29:30');
/*!40000 ALTER TABLE `imagenes` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `justificaciones`
--

DROP TABLE IF EXISTS `justificaciones`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `justificaciones` (
  `id` int NOT NULL AUTO_INCREMENT,
  `asistencia_id` int NOT NULL,
  `tipo_justificacion` enum('ENFERMEDAD','EMERGENCIA_FAMILIAR','CITA_MEDICA','OTRO') COLLATE utf8mb4_unicode_ci NOT NULL,
  `descripcion` text COLLATE utf8mb4_unicode_ci NOT NULL,
  `documento_adjunto` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `justificado_por` int DEFAULT NULL COMMENT 'ID del padre que justifica',
  `fecha_justificacion` datetime DEFAULT CURRENT_TIMESTAMP,
  `estado` enum('PENDIENTE','APROBADO','RECHAZADO') COLLATE utf8mb4_unicode_ci DEFAULT 'PENDIENTE',
  `aprobado_por` int DEFAULT NULL COMMENT 'ID del administrador/profesor que aprueba',
  `fecha_aprobacion` datetime DEFAULT NULL,
  `observaciones_aprobacion` text COLLATE utf8mb4_unicode_ci,
  `activo` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1=Activo, 0=Eliminado',
  PRIMARY KEY (`id`),
  KEY `fk_justificaciones_asistencia` (`asistencia_id`),
  KEY `idx_estado` (`estado`),
  KEY `idx_activo` (`activo`),
  KEY `idx_justificaciones_estado_fecha` (`estado`,`fecha_justificacion`),
  CONSTRAINT `fk_justificaciones_asistencia` FOREIGN KEY (`asistencia_id`) REFERENCES `asistencias` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `justificaciones`
--

LOCK TABLES `justificaciones` WRITE;
/*!40000 ALTER TABLE `justificaciones` DISABLE KEYS */;
INSERT INTO `justificaciones` VALUES (2,8,'ENFERMEDAD','El alumno estaba enfermo',NULL,16,'2025-10-18 02:38:04','PENDIENTE',NULL,NULL,NULL,1),(4,33,'CITA_MEDICA','SI',NULL,26,'2025-10-20 00:32:33','PENDIENTE',NULL,NULL,NULL,1),(5,32,'OTRO','si',NULL,20,'2025-10-20 00:33:32','PENDIENTE',NULL,NULL,NULL,1),(6,82,'ENFERMEDAD','Se le cayo los dedos',NULL,79,'2025-10-20 15:32:22','PENDIENTE',NULL,NULL,NULL,1),(7,129,'ENFERMEDAD','tiene tos',NULL,96,'2025-10-20 19:25:11','PENDIENTE',NULL,NULL,NULL,1),(9,51,'ENFERMEDAD','Se lesiono la pierna',NULL,172,'2025-10-20 21:54:31','PENDIENTE',NULL,NULL,NULL,1),(10,204,'CITA_MEDICA','Tuvo una emergencia con sus brakets, tuvo que ir al dentista urgentemente, las disculpas del caso',NULL,16,'2025-11-29 23:42:42','RECHAZADO',1,'2025-11-29 23:43:30','no.',1);
/*!40000 ALTER TABLE `justificaciones` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `notas`
--

DROP TABLE IF EXISTS `notas`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `notas` (
  `id` int NOT NULL AUTO_INCREMENT,
  `curso_id` int NOT NULL,
  `tarea_id` int NOT NULL,
  `alumno_id` int NOT NULL,
  `nota` decimal(5,2) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `curso_id` (`curso_id`),
  KEY `tarea_id` (`tarea_id`),
  KEY `alumno_id` (`alumno_id`),
  CONSTRAINT `notas_ibfk_1` FOREIGN KEY (`curso_id`) REFERENCES `cursos` (`id`) ON DELETE CASCADE,
  CONSTRAINT `notas_ibfk_2` FOREIGN KEY (`tarea_id`) REFERENCES `tareas` (`id`) ON DELETE CASCADE,
  CONSTRAINT `notas_ibfk_3` FOREIGN KEY (`alumno_id`) REFERENCES `alumnos` (`id`) ON DELETE CASCADE,
  CONSTRAINT `notas_chk_1` CHECK ((`nota` between 0 and 20))
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `notas`
--

LOCK TABLES `notas` WRITE;
/*!40000 ALTER TABLE `notas` DISABLE KEYS */;
INSERT INTO `notas` VALUES (2,22,4,26,18.00),(3,140,6,21,15.00),(4,83,8,152,13.00),(5,83,8,140,20.00),(6,27,5,33,15.00),(7,22,4,31,13.00),(9,140,6,217,20.00),(10,137,11,21,18.00),(11,140,12,21,8.00),(12,140,13,214,13.00),(13,140,13,21,18.00),(14,22,14,30,3.00);
/*!40000 ALTER TABLE `notas` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `observaciones`
--

DROP TABLE IF EXISTS `observaciones`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `observaciones` (
  `id` int NOT NULL AUTO_INCREMENT,
  `curso_id` int NOT NULL,
  `alumno_id` int NOT NULL,
  `texto` text COLLATE utf8mb4_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `curso_id` (`curso_id`),
  KEY `alumno_id` (`alumno_id`),
  CONSTRAINT `observaciones_ibfk_1` FOREIGN KEY (`curso_id`) REFERENCES `cursos` (`id`),
  CONSTRAINT `observaciones_ibfk_2` FOREIGN KEY (`alumno_id`) REFERENCES `alumnos` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=16 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `observaciones`
--

LOCK TABLES `observaciones` WRITE;
/*!40000 ALTER TABLE `observaciones` DISABLE KEYS */;
INSERT INTO `observaciones` VALUES (2,27,47,'el alumno no trabaja en clase'),(3,22,31,'El alumno trabaja de manera activa en clase'),(4,22,25,'La alumna se gano un punto para su examen mensual'),(5,22,23,'Felicitar a la alumna por la tarea bien hecha'),(6,140,21,'La alumna cumplio muy bien su tarea'),(7,83,152,'La lamina que trajo muy bonita\r\n'),(8,83,145,'No trabaja en clase y distrae a los amigos'),(11,137,21,'Buen trabajo\r\n'),(12,140,21,'ashgdjdsagfjgsjdfghsjdgfhjsd'),(13,140,21,'hizo una buena evaluacion t3'),(14,137,21,'No cumplio la tarea de la Semana 12\r\n'),(15,22,30,'TRABAJO PERFECTO ');
/*!40000 ALTER TABLE `observaciones` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `parametros_asistencia`
--

DROP TABLE IF EXISTS `parametros_asistencia`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `parametros_asistencia` (
  `id` int NOT NULL AUTO_INCREMENT,
  `clave` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `valor` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `descripcion` text COLLATE utf8mb4_unicode_ci,
  `activo` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1=Parámetro activo, 0=Inactivo',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_clave` (`clave`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `parametros_asistencia`
--

LOCK TABLES `parametros_asistencia` WRITE;
/*!40000 ALTER TABLE `parametros_asistencia` DISABLE KEYS */;
INSERT INTO `parametros_asistencia` VALUES (1,'HORA_INICIO_TARDANZA','08:15','Hora límite para considerar tardanza en turno mañana',1),(2,'HORA_INICIO_TARDANZA_TARDE','13:15','Hora límite para considerar tardanza en turno tarde',1),(3,'MAXIMO_TARDANZAS','3','Número máximo de tardanzas permitidas por mes',1),(4,'PORCENTAJE_ASISTENCIA_MINIMO','75','Porcentaje mínimo de asistencia requerido según normas peruanas',1),(5,'DIAS_JUSTIFICACION','3','Días máximos para justificar una ausencia',1),(6,'HORAS_CLASE_DIARIAS','6','Horas de clase por día en el colegio',1),(7,'TOLERANCIA_TARDANZA','15','Minutos de tolerancia para tardanzas',1);
/*!40000 ALTER TABLE `parametros_asistencia` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `profesores`
--

DROP TABLE IF EXISTS `profesores`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `profesores` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombres` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `apellidos` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `correo` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `especialidad` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `profesores`
--

LOCK TABLES `profesores` WRITE;
/*!40000 ALTER TABLE `profesores` DISABLE KEYS */;
INSERT INTO `profesores` VALUES (5,'Nick','Flores','nickflores@gmail.com','Biologia'),(6,'Juan','Tapia','juantapia@gmail.com','Historia'),(7,'Sofia','Quiroz','sofiaquiroz@gmail.com','Matematica'),(8,'Luis','Garcia','luisgarcia@gmail.com','Matematica'),(9,'Ana','Lopez','analopez@gmail.com','Comunicacion'),(10,'Pedro','Torres','pedrotorres@gmail.com','Geografia'),(11,'Laura','Diaz','lauradiaz@gmail.com','Historia'),(12,'Carlos','Martinez','carlosmartinez@gmail.com','Educacion Fisica'),(13,'Andrea','Santos','andreasantos@gmail.com','Arte y Cultura'),(14,'Jorge','Perez','jorgeperez@gmail.com','Matematica'),(15,'Valeria','Ruiz','valeriaruiz@gmail.com','Quimica'),(16,'Fernando','Ramos','fernandoramos@gmail.com','Educacion Religiosa'),(17,'Isabel','Castro','isabelcastro@gmail.com','Computacion');
/*!40000 ALTER TABLE `profesores` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `sedes`
--

DROP TABLE IF EXISTS `sedes`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `sedes` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `direccion` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `telefono` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `activo` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1=Activo, 0=Inactivo',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `sedes`
--

LOCK TABLES `sedes` WRITE;
/*!40000 ALTER TABLE `sedes` DISABLE KEYS */;
INSERT INTO `sedes` VALUES (1,'Sede Principal','Av. Principal 123, Lima','+51 1 2345678',1),(2,'Sede Norte','Av. Norte 456, Los Olivos','+51 1 2345679',1),(3,'Sede Sur','Av. Sur 789, Villa El Salvador','+51 1 2345680',1);
/*!40000 ALTER TABLE `sedes` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `tareas`
--

DROP TABLE IF EXISTS `tareas`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `tareas` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `descripcion` text COLLATE utf8mb4_unicode_ci,
  `fecha_entrega` date DEFAULT NULL,
  `activo` tinyint(1) NOT NULL DEFAULT '1',
  `curso_id` int NOT NULL,
  PRIMARY KEY (`id`),
  KEY `curso_id` (`curso_id`),
  CONSTRAINT `tareas_ibfk_1` FOREIGN KEY (`curso_id`) REFERENCES `cursos` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `tareas`
--

LOCK TABLES `tareas` WRITE;
/*!40000 ALTER TABLE `tareas` DISABLE KEYS */;
INSERT INTO `tareas` VALUES (4,'Tarea semana 1','Hacer una lamina','2025-06-08',1,22),(5,'Tarea semana 1','dibujar ','2025-06-04',0,27),(6,'Semana 2','Realizar un cuadro','2025-06-23',1,140),(8,'Tarea semana 1','Traer una lamina','2025-06-03',1,83),(9,'Tarea semana 5','Traer una revista de historia','2025-06-04',0,92),(11,'Semana 1','Resolver ejercicios pagina 50','2025-06-22',1,137),(12,'Semana 3','Hola:D','2025-06-23',1,140),(13,'semana 13','evaluaciont3','2025-06-28',0,140),(14,'CUENTO','TAREA ENTREGAR PLAZO A UNA SEMANA ','2025-10-27',1,22);
/*!40000 ALTER TABLE `tareas` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `turnos`
--

DROP TABLE IF EXISTS `turnos`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `turnos` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'MAÑANA, TARDE',
  `hora_inicio` time NOT NULL,
  `hora_fin` time NOT NULL,
  `activo` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1=Activo, 0=Inactivo',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `turnos`
--

LOCK TABLES `turnos` WRITE;
/*!40000 ALTER TABLE `turnos` DISABLE KEYS */;
INSERT INTO `turnos` VALUES (1,'MAÑANA','08:00:00','13:00:00',1),(2,'TARDE','13:00:00','18:00:00',1);
/*!40000 ALTER TABLE `turnos` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `usuarios`
--

DROP TABLE IF EXISTS `usuarios`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `usuarios` (
  `id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `password` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `rol` varchar(20) COLLATE utf8mb4_unicode_ci NOT NULL,
  `intentos_fallidos` int NOT NULL DEFAULT '0',
  `fecha_bloqueo` datetime DEFAULT NULL,
  `ultima_conexion` datetime DEFAULT NULL,
  `activo` tinyint(1) NOT NULL DEFAULT '1',
  PRIMARY KEY (`id`),
  KEY `idx_usuarios_activo` (`activo`),
  KEY `idx_usuarios_fecha_bloqueo` (`fecha_bloqueo`)
) ENGINE=InnoDB AUTO_INCREMENT=287 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `usuarios`
--

LOCK TABLES `usuarios` WRITE;
/*!40000 ALTER TABLE `usuarios` DISABLE KEYS */;
INSERT INTO `usuarios` VALUES (3,'juantapia','bb85929c7a7f71d044d9af9ae7c526f4729a06fce2c0aa334c67a9970b43448e','docente',0,NULL,'2025-11-28 02:32:08',1),(4,'luisgarcia','7951db2a127b7918f7ac4ba402f5a17d990d8064b4b29ab5153209f7c3d871a7','docente',0,NULL,NULL,1),(5,'nickflores','2e840d5620d8ecf51f9d59357c99bc029bcda45cff38e23842ef7e85cc123522','docente',0,NULL,NULL,1),(6,'juantapia','bb85929c7a7f71d044d9af9ae7c526f4729a06fce2c0aa334c67a9970b43448e','docente',0,NULL,'2025-11-28 02:32:08',1),(7,'sofiaquiroz','9908a29ae5d4034885237b79025b93922c566d11d9b1d70f300eccfa504518f9','docente',0,NULL,NULL,1),(8,'luisgarcia','7951db2a127b7918f7ac4ba402f5a17d990d8064b4b29ab5153209f7c3d871a7','docente',0,NULL,NULL,1),(9,'analopez','2a4c8b680ffccfdcc09ab0ebe35dd41d1ad3fc2395cdf023fc04671204911821','docente',0,NULL,NULL,1),(10,'pedrotorres','8e12ff675ec9d7198e02aa098016a69164172a67540c727e14c7cfb653f41278','docente',0,NULL,NULL,1),(11,'carlosmartinez','b699829a7b212bf05af0fca2af505d21fc172d06a4b39f5d826f5ba94311e6c6','docente',0,NULL,NULL,1),(12,'andreasantos','97acbc8c8e69bf80beb37a5d24043327bf7536ec0f495a0940f38f26f06359c4','docente',0,NULL,NULL,1),(13,'valeriaruiz','b2e544b2a1057808368468d24b6dca788403ca31e5de9200b873756e96840585','docente',0,NULL,'2025-10-20 19:22:50',1),(14,'fernandoramos','cb5ab980b6a01276507f8d8a110370df75ded985171f29bcf2e4274569506dc1','docente',0,NULL,'2025-10-20 00:31:13',1),(15,'isabelcastro','6c1ce13723ae2c876ca5b31ca8a0a0ca41893fbee0393202eddd50b514340849','docente',0,NULL,NULL,1),(16,'milagroscandela','43ba5e23cf97544f317ca6f4a9bc59eef9ecc5af4c9ecc3b005eba264aec1fe5','padre',0,NULL,'2025-11-10 08:11:02',1),(17,'luistorres','c25b4c8c4d5fba564446312a116ab5c56e9cb65486fbb6135395295ea79e43db','padre',0,NULL,NULL,1),(18,'anarivas','06a7fec8eb28f88a97b632def4905271c67580bfa4d3ce6568c571acb1af3a49','padre',0,NULL,NULL,1),(19,'carlosvega','83721ae975cfc12899662fc2a90cc662821551e2186b105b7fd516c191ebd730','padre',0,NULL,NULL,1),(20,'lauraparedes','a5bfc5c86f97e50b084bbf34fd00ea399e2eceb1befe9007fd822385bdd695c3','padre',0,NULL,'2025-10-20 00:33:14',1),(21,'diegoherrera','cc44288d5845b0190e60f24cd893b755c1413ba1fddd8c3dc8909e08374603c6','padre',0,NULL,NULL,1),(22,'elenaruiz','1089c0da1f8aa6cfa309b9830c63cabb3cc6bb97efb9a8b7320e42d8c454dfc7','padre',0,NULL,NULL,1),(23,'marcodiaz','b17bba72407dae737d638d5a236961da045d5c4bab3b8d443c10d020e74c612c','padre',0,NULL,NULL,1),(24,'luciasalas','8f04a9e7a8395d1980bdf318f881ab209192e9973d5b87cd660b23a1fb78249a','padre',0,NULL,'2025-10-20 19:21:50',1),(25,'pedrocastillo','b0fb954bd3e5e153b473d9dd24c82f7e37c2921143c684bb95c2a49baf99fa0a','padre',0,NULL,'2025-10-20 21:50:40',1),(26,'sofiaramos','48bd5839a2cc712aeb1539a1ed7145a4ac37bd46c52d22131ff4959a1bfeb352','padre',0,NULL,'2025-10-20 00:32:13',1),(27,'lucasperez','e55585b7b21fd9eff2f382b6885bc0e922712a1e61a0cf085e733316848b4fd5','padre',0,NULL,NULL,1),(28,'emmalopez','37b9896c320ae84aafa056e67f068f03024d9bb575087e4db935729985300cdc','padre',0,NULL,NULL,1),(29,'mateogarcia','bdd27c06ea2bfa7ca046f8f488dee2164d08770e12b66db034386b75e54b2fec','padre',0,NULL,NULL,1),(30,'sofiatorres','acabb5bca64f50379566b775f51aa49c0c40f64a0912e9cfd643a3ae6c860f70','padre',0,NULL,NULL,1),(31,'diegomartinez','45c50a48792aed6a6ff845229fd83b3a439c63f7991dda091b72edf19d2530ba','padre',0,NULL,NULL,1),(32,'valeriadiaz','84a3c4bfeda4b65bb42ac357d43b0602e1b81880e2532daa8efde40f7d1c50a4','padre',0,NULL,NULL,1),(33,'santiagovargas','07b39ce1b10863d829630a401fdcac2362cede25e195bace90c1e1fd3eaf8424','padre',0,NULL,NULL,1),(34,'camilaruiz','9da61ce3852f7aa01b5a625c9e2dd4b60068deb9fded436440c08b9db6f759f4','padre',0,NULL,NULL,1),(35,'benjaminramos','aad5c795d41e7c465ef5d7eb22bf1b131f7f69270d5e4964c51df35d2ab328c4','padre',0,NULL,NULL,1),(36,'isabellasantos','94b2af5de7b9969c3ca9a8831aec3e01d01bcfb4e60d5206434569c83caeaf84','padre',0,NULL,NULL,1),(37,'dylanmorales','31ae1bb9608af1f34c73586273ab58d5fd9337f6d2be673b3b4b49145e8d677b','padre',0,NULL,'2025-10-20 19:24:27',1),(38,'valentinaflores','b62aff4c3b5ee28f1cd3bd84ee6f91669529b93a85e62e3b11e470476d691364','padre',0,NULL,NULL,1),(39,'thiagomendez','997275212460b5531f528203c85c919f93f73ebf5952dcc69b04d252e2c35214','padre',0,NULL,NULL,1),(40,'luciacastro','45e3630fad64a22c0b7a81420c2a0019c9f22f76e9b23e84e2dc0b55f075364a','padre',0,NULL,NULL,1),(41,'gaelcampos','a373f2e1b27b3069778c74666bb9ec99ec43fa980b5789449d440096030e36c3','padre',0,NULL,NULL,1),(42,'aaronparedes','c3ed4c66e9b5854d076b487a2ac5951cd591bd1547ad98ae24d08dcbe402bf2c','padre',0,NULL,NULL,1),(43,'danielasilva','bec1783d6641a99929214c358c2a1dd63c8f727a4bb50d6639bf83b88d712f70','padre',0,NULL,NULL,1),(44,'iancortez','9cd5455bd6686e755e84e538bbddeabbb2967cf46a8b3446ea8087e84b2189bd','padre',0,NULL,NULL,1),(45,'victoriareyes','4f85a6140d30d261a9a1bfbd365f726fa2319141b2e41b152cbb3b9fa3aff2fe','padre',0,NULL,NULL,1),(46,'leonardocastillo','cc84aabb7d68811be793833b1c720f957ac97dfaaa98a4eefe87f79e1b4df2f9','padre',0,NULL,NULL,1),(47,'mariapaz','94a07dba2edda9613a25f6fcf21e34ca68966081d2d4a6e3db5518678f09f3bd','padre',0,NULL,NULL,1),(48,'brunosalazar','c1149ac311222b09365e5f23ab9307dc87186920c79101a4003049b6722e3654','padre',0,NULL,NULL,1),(49,'renataherrera','424eef1fa7c28f1f27cbb929cf02d2306cda70cf6a55f52157dd713f05c158f1','padre',0,NULL,NULL,1),(50,'samuelfuentes','5d135b3f35a2488b93b06a2083ead285b7335e7ac682f3d76e21ba180290c053','padre',0,NULL,NULL,1),(51,'alexavega','a20bdf70151a882ffa86f743a8442a6ee27b5609b63330c13f5e16bd54a24d14','padre',0,NULL,NULL,1),(52,'juliancarrillo','184c35d108c7565260aa278deae10f77dcb31749a8cdd55f34735c0b5dfd949b','padre',0,NULL,NULL,1),(53,'zoecampos','582c114817931228c0523688efd1b57fd595e35d1a8ff353e87619b6d7b8fd65','padre',0,NULL,NULL,1),(54,'andresluna','275b78bd0fd7c26050456e43084d87ddc6d1bbe0d4379ea68ac7993a0cd452e2','padre',0,NULL,NULL,1),(55,'martinagutierrez','717ac834dbb06c5ec590b4b490b8d5c16eb4f42e9ae162dc784b167c52518c20','padre',0,NULL,NULL,1),(56,'cristianserrano','4dd4f4a6352bd56c98892669f9cb9ad6c53eeb49384c659bb2fe405dcfc62ff1','padre',0,NULL,NULL,1),(57,'lucasperez','e55585b7b21fd9eff2f382b6885bc0e922712a1e61a0cf085e733316848b4fd5','padre',0,NULL,NULL,1),(58,'emmalopez','37b9896c320ae84aafa056e67f068f03024d9bb575087e4db935729985300cdc','padre',0,NULL,NULL,1),(59,'mateogarcia','bdd27c06ea2bfa7ca046f8f488dee2164d08770e12b66db034386b75e54b2fec','padre',0,NULL,NULL,1),(60,'sofiatorres','acabb5bca64f50379566b775f51aa49c0c40f64a0912e9cfd643a3ae6c860f70','padre',0,NULL,NULL,1),(61,'diegomartinez','45c50a48792aed6a6ff845229fd83b3a439c63f7991dda091b72edf19d2530ba','padre',0,NULL,NULL,1),(62,'valeriadiaz','84a3c4bfeda4b65bb42ac357d43b0602e1b81880e2532daa8efde40f7d1c50a4','padre',0,NULL,NULL,1),(63,'santiagovargas','07b39ce1b10863d829630a401fdcac2362cede25e195bace90c1e1fd3eaf8424','padre',0,NULL,NULL,1),(64,'camilaruiz','9da61ce3852f7aa01b5a625c9e2dd4b60068deb9fded436440c08b9db6f759f4','padre',0,NULL,NULL,1),(65,'benjaminramos','aad5c795d41e7c465ef5d7eb22bf1b131f7f69270d5e4964c51df35d2ab328c4','padre',0,NULL,NULL,1),(66,'isabellasantos','94b2af5de7b9969c3ca9a8831aec3e01d01bcfb4e60d5206434569c83caeaf84','padre',0,NULL,NULL,1),(67,'dylanmorales','31ae1bb9608af1f34c73586273ab58d5fd9337f6d2be673b3b4b49145e8d677b','padre',0,NULL,'2025-10-20 19:24:27',1),(68,'valentinaflores','b62aff4c3b5ee28f1cd3bd84ee6f91669529b93a85e62e3b11e470476d691364','padre',0,NULL,NULL,1),(69,'thiagomendez','997275212460b5531f528203c85c919f93f73ebf5952dcc69b04d252e2c35214','padre',0,NULL,NULL,1),(70,'luciacastro','45e3630fad64a22c0b7a81420c2a0019c9f22f76e9b23e84e2dc0b55f075364a','padre',0,NULL,NULL,1),(71,'gaelcampos','a373f2e1b27b3069778c74666bb9ec99ec43fa980b5789449d440096030e36c3','padre',0,NULL,NULL,1),(72,'lucasdiaz','5afa48a7d7b612e21cced0906fee6d281291d6cdafee9cc062ad517080ada690','padre',0,NULL,NULL,1),(73,'emmagarcia','7dbd7f419b967f2aa71b39bf0125eb4217a1922cb59ab50e66f508800c4773fd','padre',0,NULL,NULL,1),(74,'mateoruiz','242a8b62f0267fdc1d5b74656320bab5535ab027d11fc1db4aef4f2bb4dd8918','padre',0,NULL,NULL,1),(75,'sofialopez','f568bb6c2bcf25f66efd3c4e899e09fd6f78a8e246360a314a14df99ba797543','padre',0,NULL,NULL,1),(76,'diegocampos','522f783de9e455469bb97b05fe8dfd36d6d136389653287c09ef22d0cd20d341','padre',0,NULL,NULL,1),(77,'valeriaperez','626b733c05cbe3ec8d0ce8c97f9d3762d6be5dbb9bc92219ed7ff388f189462c','padre',0,NULL,NULL,1),(78,'santiagoramos','8a99bc10112b864e190b148b3cdbe9154cee0db7b8ae3c2ec0adffb58ee84418','padre',0,NULL,NULL,1),(79,'camilatorres','7859a8825fdeda1fb079efec75c87c866d209749c1b87ae0e004403b4cfb9e79','padre',0,NULL,'2025-10-20 15:33:27',1),(80,'benjaminsantos','b0899742da6c0df1f4877d25bf048db182b00079d442fe158394fd7428221bc7','padre',0,NULL,NULL,1),(81,'isabellaflores','2b0d1effea45fecfe549f645a5579f5e01b9e19d2ecc5ad24a479a8ffb075668','padre',0,NULL,NULL,1),(82,'dylanmorales','31ae1bb9608af1f34c73586273ab58d5fd9337f6d2be673b3b4b49145e8d677b','padre',0,NULL,'2025-10-20 19:24:27',1),(83,'valentinamartinez','f00fe8da01a4f5a57f9a36f4e83f4cf87cb566c970b4dce7e6e5c02e184d4249','padre',0,NULL,NULL,1),(84,'thiagorosales','f83ea3717119c4f1ea1aab6ecd4cf7f53a6fa423200f68864112d9b1f9faff1d','padre',0,NULL,NULL,1),(85,'luciavargas','6d58673570aa9f4a0c46e3fda6cfdcfc6389949914f17a6c040f741b5357fad1','padre',0,NULL,NULL,1),(86,'gaelcastro','1579d3c7f96d1f1a45a8abc1267d2b67626230a8888b60762c18caa57a4f3b02','padre',0,NULL,NULL,1),(87,'alextorres','344d675b6aa31c2d6591bc9ed4f27420dca94ce28a8e93d53a37a7e3fae52449','padre',0,NULL,NULL,1),(88,'emmacastro','df1446aac048c880c11fe7574ca5484cde3a9892d38a7f04d021ff14aeb0695f','padre',0,NULL,NULL,1),(89,'thiagodiaz','5fb7839f667450932cea3439cb3b34a90891f88413c2b15095cc66ccd3de3e7f','padre',0,NULL,NULL,1),(90,'luciamorales','5f3fa1cb54fc969c32aa24054a8b149dfe4fffbdcf90f54c676c3701f3b17bd7','padre',0,NULL,NULL,1),(91,'mateochavez','504aa9ca0745cd787e525b1e4039eb4b9d9a4df4476ca151c5ec41b682b0148d','padre',0,NULL,NULL,1),(92,'camilaparedes','464836e31ff685eab6ec011b2aded5bb67d5667beb5dd8b171af5c08fd0195ae','padre',0,NULL,NULL,1),(93,'benjaminfuentes','2caf14dc1886ccb1697522ffcb5f2d5e49431e303b8911db7d58db7054afaef9','padre',0,NULL,NULL,1),(94,'valentinagarcia','5caeb689b1fa649f256f625f4e419b6327e562966709400a4fac1431ace4c9fa','padre',0,NULL,NULL,1),(95,'santiagolopez','60e59fcb2e0e1e066b3b269dbd1079aa126f27d5a8edb7c30e3084d933f9cd4d','padre',0,NULL,NULL,1),(96,'isabellacampos','ae603fb6c633439476b7558b8ed52d04cbbf8d2e3b53508474c0a9a0d5def789','padre',0,NULL,'2025-10-20 19:24:58',1),(97,'dylanvargas','b0217029dfce2cce6c5d5a6adbba1111123d8562d307016442631e9073e7f1af','padre',0,NULL,NULL,1),(98,'sofiarios','5c35bd000637bb9096be6253794ce595ef624bfdd530ecfad55d942c2926c716','padre',0,NULL,NULL,1),(99,'leonardomendoza','9d7d7d5c0c946bc195d37ec1e55e898ef750534c492b4b84d80bce1dc1659897','padre',0,NULL,NULL,1),(100,'zoerosales','d36cd93bc9e562a78d4f921f58393a7e738df93e862ce866c142a45c2b31a071','padre',0,NULL,NULL,1),(101,'gabrielreyes','a316ce78702c9272b9eeafa28b68c5b0b9f613925ad5cf7c35f10f703e3339ad','padre',0,NULL,NULL,1),(102,'mateodiaz','38fcce0ae66c7ac900101d73d04c07ff434f36aeee2f470d7e664307f3472626','padre',0,NULL,NULL,1),(103,'emmagarcia','7dbd7f419b967f2aa71b39bf0125eb4217a1922cb59ab50e66f508800c4773fd','padre',0,NULL,NULL,1),(104,'thiagocastro','890f6c2dea5b3c737bb55aa1a1df5d552d6668641282eddc4cdbc409520beda5','padre',0,NULL,NULL,1),(105,'isabellalopez','55b40652bfc8fc0725eeb151f7029850e1bad44b5dc877b31f0601182bf49a7e','padre',0,NULL,NULL,1),(106,'lucasramos','a4422b28e38fab96be9fe1ebcb57ed261d9616ffbba4b377088dfe455d12adcc','padre',0,NULL,NULL,1),(107,'sofiatorres','acabb5bca64f50379566b775f51aa49c0c40f64a0912e9cfd643a3ae6c860f70','padre',0,NULL,NULL,1),(108,'dylanmartinez','84f279396fe15c199784b5ce5df4b80d496b7af4e0b94739197df6c044079048','padre',0,NULL,NULL,1),(109,'camilaparedes','464836e31ff685eab6ec011b2aded5bb67d5667beb5dd8b171af5c08fd0195ae','padre',0,NULL,NULL,1),(110,'gabrielvargas','6656f71e791bdadb7c62c5b5ca43f1cc463a99f43984b1119dc686f363a97e24','padre',0,NULL,NULL,1),(111,'valeriamorales','0cb8c8d013b18e34aefebce1e14eb77bcf606e85af1325e281bf6104a4607e31','padre',0,NULL,NULL,1),(112,'leonardorosales','5323e3c953c501f2b16f8224e277cea774c0e7ceae877857df3b29c6f15586e2','padre',0,NULL,NULL,1),(113,'luciareyes','a936208601e2e08e201671ccf878ce9fa269424b395b7296082d2a4774f293bd','padre',0,NULL,NULL,1),(114,'diegosantos','500722a163865a3d05e92a3080e3d8a0a9ec51f34589f4128626b9d20e77b32f','padre',0,NULL,NULL,1),(115,'valentinacampos','bbf72f8e2355ecfd26717d85daa5757118dcbf99ba382e7f4b95a2083b860326','padre',0,NULL,NULL,1),(116,'alexnavarro','b343d27520abd5b2152dcc5b21687f8ecfe61595ceeff17981d8e6397819a6a6','padre',0,NULL,NULL,1),(117,'mateogarcia','bdd27c06ea2bfa7ca046f8f488dee2164d08770e12b66db034386b75e54b2fec','padre',0,NULL,NULL,1),(118,'valerialopez','ab7d52748ec1363fff4f09a9271f9e41d75fb59b067bc8a8f87ab50ba1aade64','padre',0,NULL,NULL,1),(119,'thiagodiaz','5fb7839f667450932cea3439cb3b34a90891f88413c2b15095cc66ccd3de3e7f','padre',0,NULL,NULL,1),(120,'emmaruiz','e6c6750a3cef8f8a14780cdaefc2f5644d1c633f63fb30c869928091d9fbd95f','padre',0,NULL,NULL,1),(121,'lucastorres','da608b5cb99e623e0b5fffd1dd9743f716acfb629e1a738faba175720d017a10','padre',0,NULL,'2025-10-20 19:16:31',1),(122,'isabellavargas','d08344ebbbb5584db0c6f67d15c38c9626ee838eb03c2d2d3a6828bdbea938f9','padre',0,NULL,NULL,1),(123,'santiagoperez','c3d1955f31e1a6e231f61064f7164486ac29a420d6e4bcd71b50d7f5037ae994','padre',0,NULL,NULL,1),(124,'camilacampos','f0e84cba4c3ddddaa6340e585cce96f764d997b9ed3609594209838da5a8f827','padre',0,NULL,'2025-10-20 20:02:53',1),(125,'gabrielrosales','65a02699887a5c6042ca5deaf1bf79263b1c119ff9a14cece843f1f5b0a4e5e0','padre',0,NULL,NULL,1),(126,'luciaramos','5d6299cd57665027bbf5d7e3fbe4d0f66055f1caa9e35c1ce501a6f109fc7ec5','padre',0,NULL,NULL,1),(127,'dylanchavez','01dd47b9fbb1ace6e363d43960040c3f7b6f27e2a92a37d85f9b48d8d83d7675','padre',0,NULL,NULL,1),(128,'valentinamorales','d8d6a48d7dfeeb53e2a834b2aa4fdbc2a36168cbb08c3a3510f429eb6ba2d359','padre',0,NULL,NULL,1),(129,'benjaminparedes','56e7825302127f22796f0aa81b61453afcf4d356f40ba2e502756bfbec1e05f9','padre',0,NULL,NULL,1),(130,'sofiasantos','e10542cb9b1987d5b20fa66e50c15622e6bf25259b32f15fdfe176b005c8b940','padre',0,NULL,NULL,1),(131,'gaelmartinez','9f476917801888f6f0ab949e40a7c95c50d6bd8e725e45ae638314d588749fb7','padre',0,NULL,NULL,1),(132,'lucasdiaz','5afa48a7d7b612e21cced0906fee6d281291d6cdafee9cc062ad517080ada690','padre',0,NULL,NULL,1),(133,'emmalopez','37b9896c320ae84aafa056e67f068f03024d9bb575087e4db935729985300cdc','padre',0,NULL,NULL,1),(134,'mateoruiz','242a8b62f0267fdc1d5b74656320bab5535ab027d11fc1db4aef4f2bb4dd8918','padre',0,NULL,NULL,1),(135,'valeriagarcia','ebfd66450c8b6d741ee21309e23f09ccb23bc93dbef691813b5dd45a62f0bc2d','padre',0,NULL,NULL,1),(136,'santiagotorres','167f415b1634bb78d60268fedd77d783b6790a817da945a5ecdaa596dc638ef7','padre',0,NULL,NULL,1),(137,'camilacastro','22ab06c41117f91450c09454f6f3cba7f3090d608358d24092e6eaf88f232cf3','padre',0,NULL,NULL,1),(138,'dylanperez','5d88eacc89955e1ac4345f48ebb0a5582eb436fd1bac90970efd95b0e9e452d0','padre',0,NULL,NULL,1),(139,'isabellacampos','ae603fb6c633439476b7558b8ed52d04cbbf8d2e3b53508474c0a9a0d5def789','padre',0,NULL,'2025-10-20 19:24:58',1),(140,'gabrielvargas','6656f71e791bdadb7c62c5b5ca43f1cc463a99f43984b1119dc686f363a97e24','padre',0,NULL,NULL,1),(141,'luciarosales','79f34a060944bd9f48b6b490bfe09ad59b3be5170eadba65869dd4056ef3aa94','padre',0,NULL,NULL,1),(142,'thiagochavez','91901e63f0560e0e682e27cf9d65c9b37f60cde79cc075db7a2df9bb99f357ef','padre',0,NULL,NULL,1),(143,'valentinaramos','2849be1318f7b572b07a77f51e00f586e376c797b48fd2eef243f4da85f2eee4','padre',0,NULL,NULL,1),(144,'benjaminmorales','e3d0534769ec268384f50a7a1cf66fb525861eec48f109012a0106aeafb20474','padre',0,NULL,NULL,1),(145,'sofiasantos','e10542cb9b1987d5b20fa66e50c15622e6bf25259b32f15fdfe176b005c8b940','padre',0,NULL,NULL,1),(146,'alexparedes','c5dd40d031060a4127921c31196d2a9e47192eea4c233b00757fec39450dc251','padre',0,NULL,NULL,1),(147,'mateogarcia','bdd27c06ea2bfa7ca046f8f488dee2164d08770e12b66db034386b75e54b2fec','padre',0,NULL,NULL,1),(148,'valerialopez','ab7d52748ec1363fff4f09a9271f9e41d75fb59b067bc8a8f87ab50ba1aade64','padre',0,NULL,NULL,1),(149,'thiagodiaz','5fb7839f667450932cea3439cb3b34a90891f88413c2b15095cc66ccd3de3e7f','padre',0,NULL,NULL,1),(150,'emmaruiz','e6c6750a3cef8f8a14780cdaefc2f5644d1c633f63fb30c869928091d9fbd95f','padre',0,NULL,NULL,1),(151,'lucastorres','da608b5cb99e623e0b5fffd1dd9743f716acfb629e1a738faba175720d017a10','padre',0,NULL,'2025-10-20 19:16:31',1),(152,'isabellavargas','d08344ebbbb5584db0c6f67d15c38c9626ee838eb03c2d2d3a6828bdbea938f9','padre',0,NULL,NULL,1),(153,'santiagoperez','c3d1955f31e1a6e231f61064f7164486ac29a420d6e4bcd71b50d7f5037ae994','padre',0,NULL,NULL,1),(154,'camilacampos','f0e84cba4c3ddddaa6340e585cce96f764d997b9ed3609594209838da5a8f827','padre',0,NULL,'2025-10-20 20:02:53',1),(155,'gabrielrosales','65a02699887a5c6042ca5deaf1bf79263b1c119ff9a14cece843f1f5b0a4e5e0','padre',0,NULL,NULL,1),(156,'luciaramos','5d6299cd57665027bbf5d7e3fbe4d0f66055f1caa9e35c1ce501a6f109fc7ec5','padre',0,NULL,NULL,1),(157,'dylanchavez','01dd47b9fbb1ace6e363d43960040c3f7b6f27e2a92a37d85f9b48d8d83d7675','padre',0,NULL,NULL,1),(158,'valentinamorales','d8d6a48d7dfeeb53e2a834b2aa4fdbc2a36168cbb08c3a3510f429eb6ba2d359','padre',0,NULL,NULL,1),(159,'benjaminparedes','56e7825302127f22796f0aa81b61453afcf4d356f40ba2e502756bfbec1e05f9','padre',0,NULL,NULL,1),(160,'sofiasantos','e10542cb9b1987d5b20fa66e50c15622e6bf25259b32f15fdfe176b005c8b940','padre',0,NULL,NULL,1),(161,'alexcastro','bc8cd6f7c85c894c123b40337d52b179f56c3df7edc57a9f6978ca0ee438c07a','padre',0,NULL,NULL,1),(162,'lucasmorales','0434dc85a957b37adc768432cdad14a551c08adbf981d32819d935e6645e98b5','padre',0,NULL,NULL,1),(163,'emmagarcia','7dbd7f419b967f2aa71b39bf0125eb4217a1922cb59ab50e66f508800c4773fd','padre',0,NULL,NULL,1),(164,'mateotorres','8077301c93cb510b0a9d8739db89141ba781bde85add4ce7e50936468a9a22c4','padre',0,NULL,NULL,1),(165,'sofialopez','f568bb6c2bcf25f66efd3c4e899e09fd6f78a8e246360a314a14df99ba797543','padre',0,NULL,NULL,1),(166,'diegoperez','6911ce437e32968ffa3b720abfe026f53a9f07546469d2893b5a61f843a3bada','padre',0,NULL,NULL,1),(167,'valeriadiaz','84a3c4bfeda4b65bb42ac357d43b0602e1b81880e2532daa8efde40f7d1c50a4','padre',0,NULL,NULL,1),(168,'santiagochavez','e4e3c24886a05fc1d35a3d31002f2a5ede1a75d882fa7becde02e481bea6ec2d','padre',0,NULL,NULL,1),(169,'camilaramos','3b2a9c058e023e6b6b04370ecaf4cd4640642644b8f7c5ed8c304219b706b224','padre',0,NULL,NULL,1),(170,'benjaminvargas','456c32fcc39bdebfb8f9ce585ba60f65e8528b5ad3eb8753e9b14a8e61406fe0','padre',0,NULL,NULL,1),(171,'isabellacastro','4295a5270381a91498ee2d785ce7277b15582b0eff9854754a29b9f710f70b82','padre',0,NULL,NULL,1),(172,'dylanrosales','91dfdd80943b0b97d57b3e9f4d6e1a3f50ca60fbb8a6e17ce094ca28a6bb7476','padre',0,NULL,'2025-10-20 21:54:06',1),(173,'valentinarios','e861ac270b26a3312537c61242cfbb32b9ff5bddbf9f21e4f187081a683049bb','padre',0,NULL,NULL,1),(174,'thiagomendoza','e869e701d534277ca9ac486ac2c450be9b90de15e2d432db59b7a2a35e3bcfef','padre',0,NULL,NULL,1),(175,'luciacampos','2c9e2b6f303f82dd56d2af3ae6ae380fdae634d76c6ec98f300272e4b6acc0ea','padre',0,NULL,NULL,1),(176,'gaelparedes','802ddd0085ccfde136e0c3d98e3752af00573ce521018f30204256bca9e41a78','padre',0,NULL,NULL,1),(177,'mateodiaz','38fcce0ae66c7ac900101d73d04c07ff434f36aeee2f470d7e664307f3472626','padre',0,NULL,NULL,1),(178,'valeriagarcia','ebfd66450c8b6d741ee21309e23f09ccb23bc93dbef691813b5dd45a62f0bc2d','padre',0,NULL,NULL,1),(179,'thiagotorres','32cdefd4485bf950fb7e4cd6abb166d75dd51f2cc188f803197e0212c2aba668','padre',0,NULL,NULL,1),(180,'emmalopez','37b9896c320ae84aafa056e67f068f03024d9bb575087e4db935729985300cdc','padre',0,NULL,NULL,1),(181,'lucasruiz','12123ae284a67a3a743c5c1b7bab06b7d92fd4c4161e1bacaf49fe7fc6b7b69d','padre',0,NULL,NULL,1),(182,'isabellavargas','d08344ebbbb5584db0c6f67d15c38c9626ee838eb03c2d2d3a6828bdbea938f9','padre',0,NULL,NULL,1),(183,'santiagoperez','c3d1955f31e1a6e231f61064f7164486ac29a420d6e4bcd71b50d7f5037ae994','padre',0,NULL,NULL,1),(184,'camilacastro','22ab06c41117f91450c09454f6f3cba7f3090d608358d24092e6eaf88f232cf3','padre',0,NULL,NULL,1),(185,'gabrielramos','1c7a82526b307ccf48681e1c3a0adcc378f80c2b7c41d299d0c91329576fcdcb','padre',0,NULL,NULL,1),(186,'luciarosales','79f34a060944bd9f48b6b490bfe09ad59b3be5170eadba65869dd4056ef3aa94','padre',0,NULL,NULL,1),(187,'dylanmartinez','84f279396fe15c199784b5ce5df4b80d496b7af4e0b94739197df6c044079048','padre',0,NULL,NULL,1),(188,'valentinamorales','d8d6a48d7dfeeb53e2a834b2aa4fdbc2a36168cbb08c3a3510f429eb6ba2d359','padre',0,NULL,NULL,1),(189,'benjaminchavez','5904a8c9c3a42bffab978ee8ac4d1bd7208269af398018e6e755e751a4ff0511','padre',0,NULL,NULL,1),(190,'sofiasantos','e10542cb9b1987d5b20fa66e50c15622e6bf25259b32f15fdfe176b005c8b940','padre',0,NULL,NULL,1),(191,'alexparedes','c5dd40d031060a4127921c31196d2a9e47192eea4c233b00757fec39450dc251','padre',0,NULL,NULL,1),(192,'lucastorres','da608b5cb99e623e0b5fffd1dd9743f716acfb629e1a738faba175720d017a10','padre',0,NULL,'2025-10-20 19:16:31',1),(193,'emmagarcia','7dbd7f419b967f2aa71b39bf0125eb4217a1922cb59ab50e66f508800c4773fd','padre',0,NULL,NULL,1),(194,'mateolopez','a06dc59211447b255a0075f944897eb2a3e899b2d504977cc4e3a9fddf0d904f','padre',0,NULL,NULL,1),(195,'sofiaperez','88a4f82d2736762a6ca9522fdec9155de44abcc0ed4835c51ce4c6e54a5f0529','padre',0,NULL,NULL,1),(196,'diegovargas','ed43d1155c0533072a166c5cc80f7e2cbc68cd4d89cf298700b8979466249c2f','padre',0,NULL,NULL,1),(197,'valeriaramos','7ab9fc0ec0d6fe8872583ffae575ccf5f5332b633d88d28e1f6204747e309070','padre',0,NULL,NULL,1),(198,'santiagocastro','f2e0da1ec30c033b7563db6808a956078e0d6919f3f331a9013703212fce4e00','padre',0,NULL,NULL,1),(199,'camilachavez','4c2017e371640cc435eeea3b51d8e86049c4223c334349cd95a9d5946a499db6','padre',0,NULL,NULL,1),(200,'benjaminruiz','fa992bfc33ebc8bd44993a4734cfc77403a544ddc89621b3b743cb5821c755f3','padre',0,NULL,NULL,1),(201,'isabellarosales','d6ee19b4df15b045df82a12b67d92c48e17c40b4b410e4cf60efe74c1781b2f0','padre',0,NULL,NULL,1),(202,'dylandiaz','ae1eb274ba4ef784d1ea96a8e9626031010ece6f13d3c25d2a16729005fa98da','padre',0,NULL,NULL,1),(203,'valentinamorales','d8d6a48d7dfeeb53e2a834b2aa4fdbc2a36168cbb08c3a3510f429eb6ba2d359','padre',0,NULL,NULL,1),(204,'thiagocampos','3a458c1987e7b7b1c06b42db0f35ab83ef7a4630c5fc14ee2800cd297224c3d8','padre',0,NULL,NULL,1),(205,'luciaparedes','729f9a60e3d02fd151c907407d6ca01254c89e3d926c0f413c25d478b5091f86','padre',0,NULL,NULL,1),(206,'gabrielsantos','b3d5b0fa53e11940ccf6615ae7fa02ce5e3d60fef5b3ffbd38ea59f7af9aa98c','padre',0,NULL,NULL,1),(207,'mateogarcia','bdd27c06ea2bfa7ca046f8f488dee2164d08770e12b66db034386b75e54b2fec','padre',0,NULL,NULL,1),(208,'valerialopez','ab7d52748ec1363fff4f09a9271f9e41d75fb59b067bc8a8f87ab50ba1aade64','padre',0,NULL,NULL,1),(209,'thiagotorres','32cdefd4485bf950fb7e4cd6abb166d75dd51f2cc188f803197e0212c2aba668','padre',0,NULL,NULL,1),(210,'emmaperez','caecbe4f389f727b769c425f397762887b6985d467018a231a6013da99c3d463','padre',0,NULL,NULL,1),(211,'lucasdiaz','5afa48a7d7b612e21cced0906fee6d281291d6cdafee9cc062ad517080ada690','padre',0,NULL,NULL,1),(212,'isabellaramos','c50ad3b5ab3bbf9ef7bafef1827cefd6b6a6c18528fa6f6f32bdc7dfe8ea6a8d','padre',0,NULL,NULL,1),(213,'santiagocastro','f2e0da1ec30c033b7563db6808a956078e0d6919f3f331a9013703212fce4e00','padre',0,NULL,NULL,1),(214,'camilaruiz','9da61ce3852f7aa01b5a625c9e2dd4b60068deb9fded436440c08b9db6f759f4','padre',0,NULL,NULL,1),(215,'gabrielrosales','65a02699887a5c6042ca5deaf1bf79263b1c119ff9a14cece843f1f5b0a4e5e0','padre',0,NULL,NULL,1),(216,'luciavargas','6d58673570aa9f4a0c46e3fda6cfdcfc6389949914f17a6c040f741b5357fad1','padre',0,NULL,NULL,1),(217,'dylanchavez','01dd47b9fbb1ace6e363d43960040c3f7b6f27e2a92a37d85f9b48d8d83d7675','padre',0,NULL,NULL,1),(218,'valentinamorales','d8d6a48d7dfeeb53e2a834b2aa4fdbc2a36168cbb08c3a3510f429eb6ba2d359','padre',0,NULL,NULL,1),(219,'benjaminparedes','56e7825302127f22796f0aa81b61453afcf4d356f40ba2e502756bfbec1e05f9','padre',0,NULL,NULL,1),(220,'sofiasantos','e10542cb9b1987d5b20fa66e50c15622e6bf25259b32f15fdfe176b005c8b940','padre',0,NULL,NULL,1),(221,'alexcampos','a9082bc7b6f60e99ac49895f0c0e92df2b0c2b035e37d506fbc7acdcdab8de98','padre',0,NULL,NULL,1),(271,'admin2','1c142b2d01aa34e9a36bde480645a57fd69e14155dacfab5a3f9257b77fdc8d8','admin',0,NULL,'2025-10-20 01:35:05',1),(272,'admin3','4fc2b5673a201ad9b1fc03dcb346e1baad44351daa0503d5534b4dfdcc4332e0','admin',0,NULL,'2025-10-20 22:05:58',1),(273,'admin4','110198831a426807bccd9dbdf54b6dcb5298bc5d31ac49069e0ba3d210d970ae','admin',0,NULL,'2025-11-06 15:25:20',1),(274,'Calidad','aad67f106a0849a45116f1163ca09c73e7869587e43c8c13f148dbeef3e528c8','admin',0,NULL,'2025-10-20 01:50:14',1),(275,'MiguelAHR','cea04d446ac20442a5e9ed81b8e1c0ef6c8fefab5c72239d93174def2d708089','admin',0,NULL,'2025-11-30 10:22:23',1),(276,'Sarmiento','74f7d675387c991392c51238e6a21a42ae3c8cb77305005a8769f274569b82e4','admin',0,NULL,NULL,1),(279,'PANA','b7209b115be5eb86ce990a980e3fea11a335beb8e9c2eab0c31d3d2274667a62','admin',0,NULL,'2025-11-09 23:10:26',1),(282,'juantapia','bb85929c7a7f71d044d9af9ae7c526f4729a06fce2c0aa334c67a9970b43448e','docente',0,NULL,'2025-11-28 02:32:08',1),(283,'test','9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08','padre',0,NULL,NULL,1),(284,'admin','8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918','admin',0,NULL,NULL,1),(285,'juantapia','bb85929c7a7f71d044d9af9ae7c526f4729a06fce2c0aa334c67a9970b43448e','docente',0,NULL,'2025-11-28 02:32:08',1),(286,'PanaMiguel','13cca318e75c492602c25025426d245217045e45add9b38de012acb3023f7068','admin',0,NULL,NULL,1);
/*!40000 ALTER TABLE `usuarios` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping routines for database 'colegiogestion'
--
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_alumno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_alumno`(IN `p_id` INT, IN `p_nombres` VARCHAR(100), IN `p_apellidos` VARCHAR(100), IN `p_correo` VARCHAR(100), IN `p_fecha_nacimiento` DATE, IN `p_grado_id` INT)
BEGIN
    UPDATE alumnos 
    SET nombres = p_nombres, 
        apellidos = p_apellidos, 
        correo = p_correo, 
        fecha_nacimiento = p_fecha_nacimiento,
        grado_id = p_grado_id
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_curso` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_curso`(IN `p_id` INT, IN `p_nombre` VARCHAR(100), IN `p_grado_id` INT, IN `p_profesor_id` INT, IN `p_creditos` INT)
BEGIN
    UPDATE cursos 
    SET nombre = p_nombre, 
        grado_id = p_grado_id, 
        profesor_id = p_profesor_id, 
        creditos = p_creditos
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_grado` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_grado`(IN `p_id` INT, IN `p_nombre` VARCHAR(100), IN `p_nivel` VARCHAR(50))
BEGIN
    UPDATE grados SET nombre = p_nombre, nivel = p_nivel WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_nota` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_nota`(IN `p_id` INT, IN `p_tarea_id` INT, IN `p_alumno_id` INT, IN `p_nota` DECIMAL(5,2), IN `p_curso_id` INT)
BEGIN
    UPDATE notas 
    SET tarea_id = p_tarea_id, 
        alumno_id = p_alumno_id, 
        nota = p_nota,
        curso_id = p_curso_id
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_observacion` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_observacion`(IN `p_id` INT, IN `p_alumno_id` INT, IN `p_texto` TEXT, IN `p_curso_id` INT)
BEGIN
    UPDATE observaciones 
    SET alumno_id = p_alumno_id, 
        texto = p_texto,
        curso_id = p_curso_id
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_profesor` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_profesor`(
    IN p_id INT,
    IN p_nombres VARCHAR(100),
    IN p_apellidos VARCHAR(100),
    IN p_correo VARCHAR(100),
    IN p_especialidad VARCHAR(100)
)
BEGIN
    UPDATE profesores 
    SET nombres = p_nombres, 
        apellidos = p_apellidos, 
        correo = p_correo, 
        especialidad = p_especialidad
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_tarea` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_tarea`(IN `p_id` INT, IN `p_nombre` VARCHAR(100), IN `p_descripcion` TEXT, IN `p_fecha_entrega` DATE, IN `p_activo` BOOLEAN, IN `p_curso_id` INT)
BEGIN
    UPDATE tareas 
    SET nombre = p_nombre, 
        descripcion = p_descripcion, 
        fecha_entrega = p_fecha_entrega, 
        activo = p_activo,
        curso_id = p_curso_id
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `actualizar_usuario` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `actualizar_usuario`(IN `p_id` INT, IN `p_username` VARCHAR(50), IN `p_password` VARCHAR(100), IN `p_rol` VARCHAR(20))
BEGIN
    UPDATE usuarios 
    SET username = p_username, 
        password = p_password, 
        rol = p_rol
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `aprobar_justificacion` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `aprobar_justificacion`(IN `p_justificacion_id` INT, IN `p_aprobado_por` INT, IN `p_observaciones` TEXT)
BEGIN
    UPDATE justificaciones 
    SET estado = 'APROBADO',
        aprobado_por = p_aprobado_por,
        fecha_aprobacion = NOW(),
        observaciones_aprobacion = p_observaciones
    WHERE id = p_justificacion_id
    AND activo = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `bloquear_usuario` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `bloquear_usuario`(IN p_username VARCHAR(50))
BEGIN
    UPDATE usuarios 
    SET activo = 0, 
        fecha_bloqueo = NOW(), 
        intentos_fallidos = 3 
    WHERE username = p_username;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_alumno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_alumno`(IN `p_nombres` VARCHAR(100), IN `p_apellidos` VARCHAR(100), IN `p_correo` VARCHAR(100), IN `p_fecha_nacimiento` DATE, IN `p_grado_id` INT)
BEGIN
    INSERT INTO alumnos (nombres, apellidos, correo, fecha_nacimiento, grado_id)
    VALUES (p_nombres, p_apellidos, p_correo, p_fecha_nacimiento, p_grado_id);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_curso` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_curso`(IN `p_nombre` VARCHAR(100), IN `p_grado_id` INT, IN `p_profesor_id` INT, IN `p_creditos` INT)
BEGIN
    INSERT INTO cursos (nombre, grado_id, profesor_id, creditos)
    VALUES (p_nombre, p_grado_id, p_profesor_id, p_creditos);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_grado` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_grado`(IN `p_nombre` VARCHAR(100), IN `p_nivel` VARCHAR(50))
BEGIN
    INSERT INTO grados (nombre, nivel) VALUES (p_nombre, p_nivel);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_horario_clase` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_horario_clase`(IN `p_curso_id` INT, IN `p_turno_id` INT, IN `p_dia_semana` ENUM('LUNES','MARTES','MIERCOLES','JUEVES','VIERNES','SABADO'), IN `p_hora_inicio` TIME, IN `p_hora_fin` TIME, IN `p_aula_id` INT)
BEGIN
    INSERT INTO horarios_clase (curso_id, turno_id, dia_semana, hora_inicio, hora_fin, aula_id)
    VALUES (p_curso_id, p_turno_id, p_dia_semana, p_hora_inicio, p_hora_fin, p_aula_id);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_justificacion` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_justificacion`(IN `p_asistencia_id` INT, IN `p_tipo_justificacion` ENUM('ENFERMEDAD','EMERGENCIA_FAMILIAR','CITA_MEDICA','OTRO'), IN `p_descripcion` TEXT, IN `p_documento_adjunto` VARCHAR(255), IN `p_justificado_por` INT)
BEGIN
    DECLARE v_estado_actual VARCHAR(20);
    
    -- Verificar el estado actual de la asistencia
    SELECT estado INTO v_estado_actual FROM asistencias WHERE id = p_asistencia_id AND activo = 1;
    
    IF v_estado_actual = 'AUSENTE' THEN
        -- Insertar justificación
        INSERT INTO justificaciones (asistencia_id, tipo_justificacion, descripcion, documento_adjunto, justificado_por)
        VALUES (p_asistencia_id, p_tipo_justificacion, p_descripcion, p_documento_adjunto, p_justificado_por);
        
        -- Actualizar el estado de la asistencia a JUSTIFICADO
        UPDATE asistencias 
        SET estado = 'JUSTIFICADO',
            fecha_actualizacion = NOW()
        WHERE id = p_asistencia_id AND activo = 1;
    ELSE
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Solo se pueden justificar ausencias';
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_nota` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_nota`(IN `p_curso_id` INT, IN `p_tarea_id` INT, IN `p_alumno_id` INT, IN `p_nota` DECIMAL(5,2))
BEGIN
    INSERT INTO notas (curso_id, tarea_id, alumno_id, nota)
    VALUES (p_curso_id, p_tarea_id, p_alumno_id, p_nota);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_observacion` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_observacion`(IN `p_curso_id` INT, IN `p_alumno_id` INT, IN `p_texto` TEXT)
BEGIN
    INSERT INTO observaciones (curso_id, alumno_id, texto)
    VALUES (p_curso_id, p_alumno_id, p_texto);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_profesor` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_profesor`(
    IN p_nombres VARCHAR(100),
    IN p_apellidos VARCHAR(100),
    IN p_correo VARCHAR(100),
    IN p_especialidad VARCHAR(100)
)
BEGIN
    INSERT INTO profesores (nombres, apellidos, correo, especialidad)
    VALUES (p_nombres, p_apellidos, p_correo, p_especialidad);
    
    SELECT LAST_INSERT_ID() as id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_tarea` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_tarea`(IN `p_nombre` VARCHAR(100), IN `p_descripcion` TEXT, IN `p_fecha_entrega` DATE, IN `p_activo` BOOLEAN, IN `p_curso_id` INT)
BEGIN
    INSERT INTO tareas (nombre, descripcion, fecha_entrega, activo, curso_id)
    VALUES (p_nombre, p_descripcion, p_fecha_entrega, p_activo, p_curso_id);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `crear_usuario` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `crear_usuario`(IN `p_username` VARCHAR(50), IN `p_password` VARCHAR(100), IN `p_rol` VARCHAR(20))
BEGIN
    INSERT INTO usuarios (username, password, rol, activo) 
    VALUES (p_username, p_password, p_rol, TRUE);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `desbloquear_usuarios_expirados` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `desbloquear_usuarios_expirados`(IN p_minutos_bloqueo INT)
BEGIN
    UPDATE usuarios 
    SET intentos_fallidos = 0, 
        fecha_bloqueo = NULL, 
        activo = 1 
    WHERE activo = 0 
    AND fecha_bloqueo IS NOT NULL
    AND fecha_bloqueo < DATE_SUB(NOW(), INTERVAL p_minutos_bloqueo MINUTE);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_alumno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_alumno`(IN `p_id` INT)
BEGIN
    DELETE FROM alumnos WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_curso` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_curso`(IN `p_id` INT)
BEGIN
    DELETE FROM cursos WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_grado` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_grado`(IN `p_id` INT)
BEGIN
    DELETE FROM grados WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_nota` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_nota`(IN `p_id` INT)
BEGIN
    DELETE FROM notas WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_observacion` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_observacion`(IN `p_id` INT)
BEGIN
    DELETE FROM observaciones WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_profesor` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_profesor`(IN p_id INT)
BEGIN
    DELETE FROM profesores WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_tarea` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_tarea`(IN `p_id` INT)
BEGIN
    DELETE FROM tareas WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `eliminar_usuario` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `eliminar_usuario`(IN `p_id` INT)
BEGIN
    DELETE FROM usuarios WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `generar_reporte_trimestral_asistencia` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `generar_reporte_trimestral_asistencia`(IN `p_grado_id` INT, IN `p_turno_id` INT, IN `p_trimestre` INT, IN `p_anio` INT)
BEGIN
    DECLARE v_mes_inicio INT;
    DECLARE v_mes_fin INT;
    
    -- Determinar meses del trimestre según sistema educativo peruano
    CASE p_trimestre
        WHEN 1 THEN SET v_mes_inicio = 3, v_mes_fin = 5;   -- Marzo-Mayo
        WHEN 2 THEN SET v_mes_inicio = 6, v_mes_fin = 8;   -- Junio-Agosto
        WHEN 3 THEN SET v_mes_inicio = 9, v_mes_fin = 11;  -- Septiembre-Noviembre
        ELSE SET v_mes_inicio = 3, v_mes_fin = 5;
    END CASE;
    
    SELECT 
        al.id as alumno_id,
        CONCAT(al.nombres, ' ', al.apellidos) as alumno_nombre,
        g.nombre as grado_nombre,
        t.nombre as turno_nombre,
        COUNT(*) as total_clases_trimestre,
        SUM(CASE WHEN a.estado = 'PRESENTE' THEN 1 ELSE 0 END) as presentes,
        SUM(CASE WHEN a.estado = 'TARDANZA' THEN 1 ELSE 0 END) as tardanzas,
        SUM(CASE WHEN a.estado = 'AUSENTE' THEN 1 ELSE 0 END) as ausentes,
        SUM(CASE WHEN a.estado = 'JUSTIFICADO' THEN 1 ELSE 0 END) as justificados,
        ROUND((SUM(CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as porcentaje_asistencia,
        CASE 
            WHEN ROUND((SUM(CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) >= 90 THEN 'EXCELENTE'
            WHEN ROUND((SUM(CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) >= 75 THEN 'SATISFACTORIO'
            ELSE 'EN OBSERVACIÓN'
        END as evaluacion
    FROM alumnos al
    JOIN grados g ON al.grado_id = g.id
    JOIN asistencias a ON al.id = a.alumno_id
    JOIN turnos t ON a.turno_id = t.id
    WHERE al.grado_id = p_grado_id
    AND a.turno_id = p_turno_id
    AND MONTH(a.fecha) BETWEEN v_mes_inicio AND v_mes_fin
    AND YEAR(a.fecha) = p_anio
    AND a.activo = 1
    GROUP BY al.id, alumno_nombre, grado_nombre, turno_nombre
    ORDER BY al.apellidos, al.nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `incrementar_intento_fallido` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `incrementar_intento_fallido`(IN p_username VARCHAR(50))
BEGIN
    UPDATE usuarios 
    SET intentos_fallidos = intentos_fallidos + 1, 
        ultima_conexion = NOW() 
    WHERE username = p_username;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_alertas_asistencia_turno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_alertas_asistencia_turno`(IN `p_porcentaje_minimo` DECIMAL(5,2), IN `p_turno_id` INT)
BEGIN
    SELECT 
        al.id as alumno_id,
        CONCAT(al.nombres, ' ', al.apellidos) as alumno_nombre,
        g.nombre as grado_nombre,
        t.nombre as turno_nombre,
        COUNT(*) as total_clases,
        SUM(CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) as asistencias_validas,
        ROUND((SUM(CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as porcentaje_asistencia,
        MONTH(a.fecha) as mes,
        YEAR(a.fecha) as anio
    FROM alumnos al
    JOIN asistencias a ON al.id = a.alumno_id
    JOIN cursos c ON a.curso_id = c.id
    JOIN grados g ON c.grado_id = g.id
    JOIN turnos t ON a.turno_id = t.id
    WHERE a.turno_id = p_turno_id
    AND MONTH(a.fecha) = MONTH(CURRENT_DATE()) 
    AND YEAR(a.fecha) = YEAR(CURRENT_DATE())
    AND a.activo = 1
    GROUP BY al.id, alumno_nombre, grado_nombre, turno_nombre, mes, anio
    HAVING porcentaje_asistencia < p_porcentaje_minimo
    ORDER BY porcentaje_asistencia ASC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_alumnos` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_alumnos`()
BEGIN
    SELECT id, nombres, apellidos, correo, fecha_nacimiento, grado_id 
    FROM alumnos 
    ORDER BY apellidos, nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_alumnos_por_curso` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_alumnos_por_curso`(IN `p_curso_id` INT)
BEGIN
    SELECT 
        a.id,
        a.nombres,
        a.apellidos,
        a.correo,
        a.fecha_nacimiento,
        a.grado_id
    FROM alumnos a
    JOIN grados g ON a.grado_id = g.id
    JOIN cursos c ON g.id = c.grado_id
    WHERE c.id = p_curso_id
    AND a.id IS NOT NULL
    ORDER BY a.apellidos, a.nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_alumnos_por_grado` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_alumnos_por_grado`(IN `p_grado_id` INT)
BEGIN
    SELECT id, nombres, apellidos, correo, fecha_nacimiento, grado_id 
    FROM alumnos 
    WHERE grado_id = p_grado_id 
    ORDER BY apellidos, nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_alumno_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_alumno_por_id`(IN `p_id` INT)
BEGIN
    SELECT id, nombres, apellidos, correo, fecha_nacimiento, grado_id 
    FROM alumnos 
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_asistencias_por_alumno_turno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_asistencias_por_alumno_turno`(IN `p_alumno_id` INT, IN `p_turno_id` INT, IN `p_mes` INT, IN `p_anio` INT)
BEGIN
    SELECT a.id, a.alumno_id, a.curso_id, a.turno_id, a.fecha, a.hora_clase, a.estado, a.observaciones,
           c.nombre as curso_nombre,
           g.nombre as grado_nombre,  -- AGREGAR ESTA LÍNEA
           t.nombre as turno_nombre,
           a.registrado_por
    FROM asistencias a
    JOIN cursos c ON a.curso_id = c.id
    JOIN grados g ON c.grado_id = g.id  -- AGREGAR ESTE JOIN
    JOIN turnos t ON a.turno_id = t.id
    WHERE a.alumno_id = p_alumno_id 
    AND a.turno_id = p_turno_id
    AND MONTH(a.fecha) = p_mes 
    AND YEAR(a.fecha) = p_anio
    AND a.activo = 1
    ORDER BY a.fecha DESC, a.hora_clase DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_asistencias_por_curso_turno_fecha` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_asistencias_por_curso_turno_fecha`(IN `p_curso_id` INT, IN `p_turno_id` INT, IN `p_fecha` DATE)
BEGIN
    SELECT a.id, a.alumno_id, a.curso_id, a.turno_id, a.fecha, a.hora_clase, a.estado, a.observaciones,
           CONCAT(al.nombres, ' ', al.apellidos) as alumno_nombre,
           al.apellidos as alumno_apellidos,
           a.registrado_por,
           CONCAT(p.nombres, ' ', p.apellidos) as profesor_nombre,
           t.nombre as turno_nombre
    FROM asistencias a
    JOIN alumnos al ON a.alumno_id = al.id
    JOIN cursos c ON a.curso_id = c.id
    JOIN turnos t ON a.turno_id = t.id
    LEFT JOIN profesores p ON a.registrado_por = p.id
    WHERE a.curso_id = p_curso_id AND a.turno_id = p_turno_id AND a.fecha = p_fecha AND a.activo = 1
    ORDER BY al.apellidos, al.nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_aulas_por_sede` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_aulas_por_sede`(IN `p_sede_id` INT)
BEGIN
    SELECT a.id, a.nombre, a.capacidad, a.sede_id, s.nombre as sede_nombre
    FROM aulas a
    JOIN sedes s ON a.sede_id = s.id
    WHERE a.sede_id = p_sede_id AND a.activo = 1
    ORDER BY a.nombre;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_ausencias_por_justificar` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_ausencias_por_justificar`(IN `p_alumno_id` INT)
BEGIN
    SELECT 
        a.id,
        a.fecha,
        a.hora_clase,
        a.estado,
        c.nombre as curso_nombre,
        a.alumno_id
    FROM asistencias a
    INNER JOIN cursos c ON a.curso_id = c.id
    WHERE a.alumno_id = p_alumno_id
    AND a.estado = 'AUSENTE'
    AND a.fecha >= DATE_SUB(CURDATE(), INTERVAL 3 DAY)
    AND NOT EXISTS (
        SELECT 1 FROM justificaciones j 
        WHERE j.asistencia_id = a.id 
        AND j.estado IN ('PENDIENTE', 'APROBADO')
    )
    ORDER BY a.fecha DESC, a.hora_clase DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_cursos` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_cursos`()
BEGIN
    SELECT c.id, c.nombre, c.creditos, c.grado_id, c.profesor_id,
           g.nombre as grado_nombre,
           CONCAT(p.nombres, ' ', p.apellidos) as profesor_nombre
    FROM cursos c
    JOIN grados g ON c.grado_id = g.id
    JOIN profesores p ON c.profesor_id = p.id
    ORDER BY g.nivel, g.nombre, c.nombre;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_cursos_por_grado` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_cursos_por_grado`(IN `p_grado_id` INT)
BEGIN
    SELECT c.id, c.nombre, c.creditos, c.grado_id, c.profesor_id,
           g.nombre as grado_nombre,
           CONCAT(p.nombres, ' ', p.apellidos) as profesor_nombre
    FROM cursos c
    JOIN grados g ON c.grado_id = g.id
    JOIN profesores p ON c.profesor_id = p.id
    WHERE c.grado_id = p_grado_id
    ORDER BY c.nombre;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_cursos_por_profesor` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_cursos_por_profesor`(IN `p_profesor_id` INT)
BEGIN
    SELECT c.id, c.nombre, c.grado_id, c.profesor_id,
           CONCAT(g.nombre, ' - ', g.nivel) as grado_nombre
    FROM cursos c
    JOIN grados g ON c.grado_id = g.id
    WHERE c.profesor_id = p_profesor_id
    ORDER BY g.nivel, g.nombre, c.nombre;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_curso_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_curso_por_id`(IN `p_id` INT)
BEGIN
    SELECT c.id, c.nombre, c.creditos, c.grado_id, c.profesor_id,
           g.nombre as grado_nombre, g.nivel
    FROM cursos c
    JOIN grados g ON c.grado_id = g.id
    WHERE c.id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_datos_bloqueo_usuario` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_datos_bloqueo_usuario`(IN p_username VARCHAR(50))
BEGIN
    SELECT intentos_fallidos, fecha_bloqueo, activo, ultima_conexion
    FROM usuarios 
    WHERE username = p_username;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_estadisticas_asistencia_profesor_turno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_estadisticas_asistencia_profesor_turno`(IN `p_profesor_id` INT, IN `p_turno_id` INT, IN `p_mes` INT, IN `p_anio` INT)
BEGIN
    SELECT 
        c.id as curso_id,
        c.nombre as curso_nombre,
        g.nombre as grado_nombre,
        t.nombre as turno_nombre,
        COUNT(DISTINCT a.fecha) as dias_clase,
        COUNT(*) as total_registros,
        SUM(CASE WHEN a.estado = 'PRESENTE' THEN 1 ELSE 0 END) as presentes,
        SUM(CASE WHEN a.estado = 'TARDANZA' THEN 1 ELSE 0 END) as tardanzas,
        SUM(CASE WHEN a.estado = 'AUSENTE' THEN 1 ELSE 0 END) as ausentes,
        SUM(CASE WHEN a.estado = 'JUSTIFICADO' THEN 1 ELSE 0 END) as justificados,
        ROUND((SUM(CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as porcentaje_general
    FROM asistencias a
    JOIN cursos c ON a.curso_id = c.id
    JOIN grados g ON c.grado_id = g.id
    JOIN turnos t ON a.turno_id = t.id
    WHERE c.profesor_id = p_profesor_id 
    AND a.turno_id = p_turno_id
    AND MONTH(a.fecha) = p_mes 
    AND YEAR(a.fecha) = p_anio
    AND a.activo = 1
    GROUP BY c.id, c.nombre, g.nombre, t.nombre
    ORDER BY g.nivel, g.nombre, c.nombre;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_grados` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_grados`()
BEGIN
    SELECT id, nombre, nivel FROM grados ORDER BY nivel, nombre;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_grado_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_grado_por_id`(IN `p_id` INT)
BEGIN
    SELECT id, nombre, nivel FROM grados WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_horarios_por_curso_turno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_horarios_por_curso_turno`(IN `p_curso_id` INT, IN `p_turno_id` INT)
BEGIN
    SELECT h.id, h.curso_id, h.turno_id, h.dia_semana, h.hora_inicio, h.hora_fin, 
           h.aula_id, h.activo,
           c.nombre as curso_nombre,
           t.nombre as turno_nombre,
           a.nombre as aula_nombre,
           s.nombre as sede_nombre
    FROM horarios_clase h
    JOIN cursos c ON h.curso_id = c.id
    JOIN turnos t ON h.turno_id = t.id
    JOIN aulas a ON h.aula_id = a.id
    JOIN sedes s ON a.sede_id = s.id
    WHERE h.curso_id = p_curso_id AND h.turno_id = p_turno_id AND h.activo = 1
    ORDER BY 
        FIELD(h.dia_semana, 'LUNES', 'MARTES', 'MIERCOLES', 'JUEVES', 'VIERNES', 'SABADO'),
        h.hora_inicio;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_horarios_por_profesor_turno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_horarios_por_profesor_turno`(IN `p_profesor_id` INT, IN `p_turno_id` INT)
BEGIN
    SELECT DISTINCT h.id, h.curso_id, h.turno_id, h.dia_semana, h.hora_inicio, h.hora_fin,
           c.nombre as curso_nombre,
           g.nombre as grado_nombre,
           a.nombre as aula_nombre,
           t.nombre as turno_nombre
    FROM horarios_clase h
    JOIN cursos c ON h.curso_id = c.id
    JOIN grados g ON c.grado_id = g.id
    JOIN turnos t ON h.turno_id = t.id
    JOIN aulas a ON h.aula_id = a.id
    WHERE c.profesor_id = p_profesor_id AND h.turno_id = p_turno_id AND h.activo = 1
    ORDER BY 
        FIELD(h.dia_semana, 'LUNES', 'MARTES', 'MIERCOLES', 'JUEVES', 'VIERNES', 'SABADO'),
        h.hora_inicio;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_justificaciones_pendientes` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_justificaciones_pendientes`()
BEGIN
    SELECT 
        j.id,
        j.asistencia_id,
        j.tipo_justificacion,
        j.descripcion,
        j.documento_adjunto,
        j.fecha_justificacion,
        j.estado,
        j.observaciones_aprobacion,
        CONCAT(a.nombres, ' ', a.apellidos) as alumno_nombre,
        c.nombre as curso_nombre,
        asi.fecha,
        asi.hora_clase,
        u.username as padre_nombre  -- Usamos username como padre_nombre temporalmente
    FROM justificaciones j
    JOIN asistencias asi ON j.asistencia_id = asi.id
    JOIN alumnos a ON asi.alumno_id = a.id
    JOIN cursos c ON asi.curso_id = c.id
    LEFT JOIN usuarios u ON j.justificado_por = u.id
    WHERE j.estado = 'PENDIENTE'
    AND j.activo = 1
    ORDER BY j.fecha_justificacion DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_justificaciones_por_alumno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_justificaciones_por_alumno`(IN `p_alumno_id` INT)
BEGIN
    SELECT 
        j.id,
        j.asistencia_id,
        j.tipo_justificacion,
        j.descripcion,
        j.documento_adjunto,
        j.fecha_justificacion,
        j.estado,
        j.observaciones_aprobacion,
        c.nombre as curso_nombre,
        asi.fecha,
        asi.hora_clase,
        u.username as padre_nombre  -- Usamos username como padre_nombre temporalmente
    FROM justificaciones j
    JOIN asistencias asi ON j.asistencia_id = asi.id
    JOIN cursos c ON asi.curso_id = c.id
    LEFT JOIN usuarios u ON j.justificado_por = u.id
    WHERE asi.alumno_id = p_alumno_id
    AND j.activo = 1
    ORDER BY j.fecha_justificacion DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_notas_por_alumno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_notas_por_alumno`(IN `p_alumno_id` INT)
BEGIN
    SELECT n.id, n.curso_id, n.tarea_id, n.alumno_id, n.nota,
           t.nombre as tarea_nombre,
           c.nombre as curso_nombre
    FROM notas n
    JOIN tareas t ON n.tarea_id = t.id
    JOIN cursos c ON n.curso_id = c.id
    WHERE n.alumno_id = p_alumno_id
    ORDER BY t.fecha_entrega DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_notas_por_curso` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_notas_por_curso`(IN `p_curso_id` INT)
BEGIN
    SELECT n.id, n.curso_id, n.tarea_id, n.alumno_id, n.nota,
           CONCAT(a.nombres, ' ', a.apellidos) as alumno_nombres,
           a.apellidos as alumno_apellidos,
           t.nombre as tarea_nombre
    FROM notas n
    JOIN alumnos a ON n.alumno_id = a.id
    JOIN tareas t ON n.tarea_id = t.id
    WHERE n.curso_id = p_curso_id
    ORDER BY a.apellidos, a.nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_nota_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_nota_por_id`(IN `p_id` INT)
BEGIN
    SELECT n.id, n.curso_id, n.tarea_id, n.alumno_id, n.nota,
           CONCAT(a.nombres, ' ', a.apellidos) as alumno_nombres,
           a.apellidos as alumno_apellidos,
           t.nombre as tarea_nombre
    FROM notas n
    JOIN alumnos a ON n.alumno_id = a.id
    JOIN tareas t ON n.tarea_id = t.id
    WHERE n.id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_observaciones_por_alumno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_observaciones_por_alumno`(IN `p_alumno_id` INT)
BEGIN
    SELECT o.id, o.curso_id, o.alumno_id, o.texto,
           c.nombre as curso_nombre
    FROM observaciones o
    JOIN cursos c ON o.curso_id = c.id
    WHERE o.alumno_id = p_alumno_id
    ORDER BY o.id DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_observaciones_por_curso` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_observaciones_por_curso`(IN `p_curso_id` INT)
BEGIN
    SELECT o.id, o.curso_id, o.alumno_id, o.texto,
           CONCAT(a.nombres, ' ', a.apellidos) as alumno_nombres,
           a.apellidos as alumno_apellidos
    FROM observaciones o
    JOIN alumnos a ON o.alumno_id = a.id
    WHERE o.curso_id = p_curso_id
    ORDER BY a.apellidos, a.nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_observacion_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_observacion_por_id`(IN `p_id` INT)
BEGIN
    SELECT o.id, o.curso_id, o.alumno_id, o.texto,
           CONCAT(a.nombres, ' ', a.apellidos) as alumno_nombres,
           a.apellidos as alumno_apellidos,
           c.nombre as curso_nombre
    FROM observaciones o
    JOIN alumnos a ON o.alumno_id = a.id
    JOIN cursos c ON o.curso_id = c.id
    WHERE o.id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_planilla_asistencia_diaria` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_planilla_asistencia_diaria`(IN `p_grado_id` INT, IN `p_turno_id` INT, IN `p_fecha` DATE)
BEGIN
    SELECT 
        al.id as alumno_id,
        CONCAT(al.nombres, ' ', al.apellidos) as alumno_nombre,
        al.apellidos,
        al.nombres,
        GROUP_CONCAT(DISTINCT 
            CASE 
                WHEN a.estado IS NOT NULL THEN 
                    CONCAT(c.nombre, ': ', a.estado)
                ELSE 
                    CONCAT(c.nombre, ': SIN REGISTRO')
            END
            ORDER BY c.nombre SEPARATOR '; '
        ) as resumen_cursos,
        COUNT(DISTINCT c.id) as total_cursos,
        COUNT(DISTINCT CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA') THEN c.id END) as cursos_asistidos,
        CASE 
            WHEN COUNT(DISTINCT c.id) = COUNT(DISTINCT CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA') THEN c.id END) THEN 'ASISTIÓ'
            WHEN COUNT(DISTINCT CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA') THEN c.id END) = 0 THEN 'AUSENTE'
            ELSE 'ASISTENCIA PARCIAL'
        END as estado_dia
    FROM alumnos al
    JOIN cursos c ON al.grado_id = c.grado_id
    LEFT JOIN asistencias a ON al.id = a.alumno_id AND a.curso_id = c.id AND a.fecha = p_fecha AND a.turno_id = p_turno_id AND a.activo = 1
    WHERE al.grado_id = p_grado_id
    AND c.id IN (SELECT curso_id FROM horarios_clase WHERE turno_id = p_turno_id AND dia_semana = 
        CASE DAYOFWEEK(p_fecha)
            WHEN 1 THEN 'DOMINGO'
            WHEN 2 THEN 'LUNES'
            WHEN 3 THEN 'MARTES'
            WHEN 4 THEN 'MIERCOLES'
            WHEN 5 THEN 'JUEVES'
            WHEN 6 THEN 'VIERNES'
            WHEN 7 THEN 'SABADO'
        END
        AND activo = 1)
    GROUP BY al.id, alumno_nombre, al.apellidos, al.nombres
    ORDER BY al.apellidos, al.nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_profesores` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_profesores`()
BEGIN
    SELECT * FROM profesores ORDER BY apellidos, nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_profesor_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_profesor_por_id`(IN p_id INT)
BEGIN
    SELECT * FROM profesores WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_profesor_por_username` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_profesor_por_username`(IN p_username VARCHAR(50))
BEGIN
    SELECT p.* 
    FROM profesores p
    JOIN usuarios u ON (
        p.correo COLLATE utf8mb4_unicode_ci = u.username COLLATE utf8mb4_unicode_ci 
        OR 
        CONCAT(LOWER(REPLACE(p.nombres, ' ', '')), LOWER(REPLACE(p.apellidos, ' ', ''))) COLLATE utf8mb4_unicode_ci = u.username COLLATE utf8mb4_unicode_ci
    )
    WHERE u.username COLLATE utf8mb4_unicode_ci = p_username COLLATE utf8mb4_unicode_ci 
    AND u.rol = 'docente';
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_reporte_asistencia_grado_turno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_reporte_asistencia_grado_turno`(IN `p_grado_id` INT, IN `p_turno_id` INT, IN `p_mes` INT, IN `p_anio` INT)
BEGIN
    SELECT 
        al.id as alumno_id,
        CONCAT(al.nombres, ' ', al.apellidos) as alumno_nombre,
        COUNT(*) as total_clases,
        SUM(CASE WHEN a.estado = 'PRESENTE' THEN 1 ELSE 0 END) as presentes,
        SUM(CASE WHEN a.estado = 'TARDANZA' THEN 1 ELSE 0 END) as tardanzas,
        SUM(CASE WHEN a.estado = 'AUSENTE' THEN 1 ELSE 0 END) as ausentes,
        SUM(CASE WHEN a.estado = 'JUSTIFICADO' THEN 1 ELSE 0 END) as justificados,
        ROUND((SUM(CASE WHEN a.estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as porcentaje_asistencia
    FROM alumnos al
    JOIN asistencias a ON al.id = a.alumno_id
    JOIN cursos c ON a.curso_id = c.id
    WHERE al.grado_id = p_grado_id 
    AND a.turno_id = p_turno_id
    AND MONTH(a.fecha) = p_mes 
    AND YEAR(a.fecha) = p_anio
    AND a.activo = 1
    GROUP BY al.id, alumno_nombre
    ORDER BY al.apellidos, al.nombres;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_resumen_asistencia_alumno_turno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_resumen_asistencia_alumno_turno`(IN `p_alumno_id` INT, IN `p_turno_id` INT, IN `p_mes` INT, IN `p_anio` INT)
BEGIN
    SELECT 
        COUNT(*) as total_clases,
        SUM(CASE WHEN estado = 'PRESENTE' THEN 1 ELSE 0 END) as presentes,
        SUM(CASE WHEN estado = 'TARDANZA' THEN 1 ELSE 0 END) as tardanzas,
        SUM(CASE WHEN estado = 'AUSENTE' THEN 1 ELSE 0 END) as ausentes,
        SUM(CASE WHEN estado = 'JUSTIFICADO' THEN 1 ELSE 0 END) as justificados,
        ROUND((SUM(CASE WHEN estado IN ('PRESENTE', 'TARDANZA', 'JUSTIFICADO') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as porcentaje_asistencia
    FROM asistencias 
    WHERE alumno_id = p_alumno_id 
    AND turno_id = p_turno_id
    AND MONTH(fecha) = p_mes 
    AND YEAR(fecha) = p_anio
    AND activo = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_sedes_activas` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_sedes_activas`()
BEGIN
    SELECT id, nombre, direccion, telefono 
    FROM sedes 
    WHERE activo = 1
    ORDER BY nombre;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_tareas_por_alumno` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_tareas_por_alumno`(IN `p_alumno_id` INT)
BEGIN
    SELECT t.id, t.nombre, t.descripcion, t.fecha_entrega, t.activo,
           c.nombre as curso_nombre
    FROM tareas t
    JOIN cursos c ON t.curso_id = c.id
    JOIN alumnos a ON a.grado_id = c.grado_id
    WHERE a.id = p_alumno_id AND t.activo = 1
    ORDER BY t.fecha_entrega DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_tareas_por_curso` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_tareas_por_curso`(IN `p_curso_id` INT)
BEGIN
    SELECT id, nombre, descripcion, fecha_entrega, activo, curso_id 
    FROM tareas 
    WHERE curso_id = p_curso_id
    ORDER BY fecha_entrega DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_tarea_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_tarea_por_id`(IN `p_id` INT)
BEGIN
    SELECT id, nombre, descripcion, fecha_entrega, activo, curso_id 
    FROM tareas 
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_turnos_activos` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_turnos_activos`()
BEGIN
    SELECT id, nombre, hora_inicio, hora_fin 
    FROM turnos 
    WHERE activo = 1
    ORDER BY hora_inicio;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_usuarios` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_usuarios`()
BEGIN
    SELECT id, username, password, rol, 
           intentos_fallidos, fecha_bloqueo, ultima_conexion, activo
    FROM usuarios 
    ORDER BY username;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `obtener_usuario_por_id` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `obtener_usuario_por_id`(IN `p_id` INT)
BEGIN
    SELECT id, username, password, rol,
           intentos_fallidos, fecha_bloqueo, ultima_conexion, activo
    FROM usuarios 
    WHERE id = p_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `rechazar_justificacion` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `rechazar_justificacion`(IN `p_justificacion_id` INT, IN `p_aprobado_por` INT, IN `p_observaciones` TEXT)
BEGIN
    UPDATE justificaciones 
    SET estado = 'RECHAZADO',
        aprobado_por = p_aprobado_por,
        fecha_aprobacion = NOW(),
        observaciones_aprobacion = p_observaciones
    WHERE id = p_justificacion_id
    AND activo = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `registrar_asistencia` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `registrar_asistencia`(IN `p_alumno_id` INT, IN `p_curso_id` INT, IN `p_turno_id` INT, IN `p_fecha` DATE, IN `p_hora_clase` TIME, IN `p_estado` ENUM('PRESENTE','TARDANZA','AUSENTE','JUSTIFICADO'), IN `p_observaciones` TEXT, IN `p_registrado_por` INT)
BEGIN
    DECLARE v_existe INT DEFAULT 0;
    
    -- Verificar si ya existe un registro para este alumno, curso, turno y fecha
    SELECT COUNT(*) INTO v_existe 
    FROM asistencias 
    WHERE alumno_id = p_alumno_id 
    AND curso_id = p_curso_id 
    AND turno_id = p_turno_id
    AND fecha = p_fecha 
    AND hora_clase = p_hora_clase
    AND activo = 1;
    
    IF v_existe = 0 THEN
        -- Insertar nuevo registro
        INSERT INTO asistencias (alumno_id, curso_id, turno_id, fecha, hora_clase, estado, observaciones, registrado_por)
        VALUES (p_alumno_id, p_curso_id, p_turno_id, p_fecha, p_hora_clase, p_estado, p_observaciones, p_registrado_por);
    ELSE
        -- Actualizar registro existente
        UPDATE asistencias 
        SET estado = p_estado,
            observaciones = p_observaciones,
            registrado_por = p_registrado_por,
            fecha_actualizacion = NOW()
        WHERE alumno_id = p_alumno_id 
        AND curso_id = p_curso_id 
        AND turno_id = p_turno_id
        AND fecha = p_fecha 
        AND hora_clase = p_hora_clase
        AND activo = 1;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `registrar_asistencia_grupal` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `registrar_asistencia_grupal`(IN `p_curso_id` INT, IN `p_turno_id` INT, IN `p_fecha` DATE, IN `p_hora_clase` TIME, IN `p_alumnos_json` JSON, IN `p_registrado_por` INT)
BEGIN
    DECLARE i INT DEFAULT 0;
    DECLARE v_count INT DEFAULT 0;
    DECLARE v_alumno_id INT;
    DECLARE v_estado VARCHAR(20);
    
    -- Obtener la cantidad de alumnos en el JSON
    SET v_count = JSON_LENGTH(p_alumnos_json);
    
    -- Procesar cada alumno del JSON
    WHILE i < v_count DO
        SET v_alumno_id = JSON_UNQUOTE(JSON_EXTRACT(p_alumnos_json, CONCAT('$[', i, '].alumno_id')));
        SET v_estado = JSON_UNQUOTE(JSON_EXTRACT(p_alumnos_json, CONCAT('$[', i, '].estado')));
        
        -- Llamar al procedimiento de registro individual
        CALL registrar_asistencia(v_alumno_id, p_curso_id, p_turno_id, p_fecha, p_hora_clase, v_estado, NULL, p_registrado_por);
        
        SET i = i + 1;
    END WHILE;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `resetear_intentos_usuario` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `resetear_intentos_usuario`(IN p_username VARCHAR(50))
BEGIN
    UPDATE usuarios 
    SET intentos_fallidos = 0, 
        fecha_bloqueo = NULL, 
        activo = 1 
    WHERE username = p_username;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `verificar_usuario_bloqueado` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_0900_ai_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `verificar_usuario_bloqueado`(IN p_username VARCHAR(50))
BEGIN
    DECLARE v_intentos INT;
    DECLARE v_activo BOOLEAN;
    DECLARE v_fecha_bloqueo TIMESTAMP;
    DECLARE v_bloqueado INT DEFAULT 0;
    
    -- Obtener datos del usuario
    SELECT intentos_fallidos, activo, fecha_bloqueo 
    INTO v_intentos, v_activo, v_fecha_bloqueo
    FROM usuarios 
    WHERE username = p_username;
    
    -- Lógica de bloqueo CORREGIDA
    IF v_intentos >= 3 THEN
        SET v_bloqueado = 1;
    ELSEIF v_activo = 0 AND v_fecha_bloqueo IS NOT NULL THEN
        -- Bloqueado si fue bloqueado hace menos de 1 minuto
        IF v_fecha_bloqueo > DATE_SUB(NOW(), INTERVAL 1 MINUTE) THEN
            SET v_bloqueado = 1;
        ELSE
            -- Auto-desbloquear si pasó el tiempo
            UPDATE usuarios SET activo = 1, intentos_fallidos = 0, fecha_bloqueo = NULL 
            WHERE username = p_username;
        END IF;
    END IF;
    
    SELECT v_bloqueado as bloqueado;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2025-11-30 11:37:45
